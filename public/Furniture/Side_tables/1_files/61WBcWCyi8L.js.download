'use strict';mix_d("SBVideoCards__sb-video-store-product-feature-desktop:sb-video-store-product-feature-desktop__I3nu07O2","exports tslib @c/pagemarker @c/metrics @c/scoped-dom @c/dom @p/A @p/a-ajax @c/logger @c/browser-operations @c/aui-modal @c/aui-untrusted-ajax".split(" "),function(ea,p,ab,y,bb,cb,db,eb,ua,fb,gb,hb){function G(c){return c&&"object"===typeof c&&"default"in c?c:{"default":c}}var ib=G(ab),A=G(bb),L=G(cb),t=G(db),jb=G(eb),va=G(ua),wa=G(fb),kb=G(gb),lb=G(hb),T=function(c,f){f=f||A["default"].cardRoot;
return!c||f.matches(c)?f:f.querySelector(c)},fa=function(c,f){return(f=T("["+c+"]",f))?f.getAttribute(c):null},B=function(){return L["default"].cardRoot.ownerDocument},mb=function(c){var f,g;return null===(g=null===(f=B().defaultView)||void 0===f?void 0:f.matchMedia)||void 0===g?void 0:g.call(f,c)},O;(function(c){c.BETA="beta";c.GAMMA="gamma";c.PROD="prod"})(O||(O={}));var xa=function(){function c(){}c.getStage=function(){var f=B().defaultView;return(f=f&&f.location&&f.location.hostname)?"localhost"===
f||"mix.corp.amazon.com"===f||"development.amazon.com"===f||/^[a-z]{2}-development\.amazon\.com$/.test(f)?O.BETA:/^pre-prod\.amazon\.(com|[a-z]{2})$/.test(f)||/^pre-prod\.amazon\.com?\.[a-z]{2}$/.test(f)||/^[a-z]{2}-pre-prod\.amazon\.com$/.test(f)?O.GAMMA:O.PROD:O.PROD};return c}(),nb=["motorola edge","Moto"],ob=function(){var c=t["default"].capabilities.android?"android":t["default"].capabilities.ios?"ios":"unrecognized";"unrecognized"===c&&nb.forEach(function(f){navigator.userAgent.includes(f)&&
(c="android")});return"desktop"===ya()?"unrecognized":c},ya=function(){return t["default"].capabilities.mobile?"mobile":t["default"].capabilities.tablet?"tablet":"desktop"},za=function(){},pb=function(c){var f=c.url,g=c.onSuccess,e=c.onError;f?jb["default"].get(f,{success:function(b){b&&"ok"===b.status?g(b):e()},error:e,abort:e}):e()},qb=function(c){var f=c.url,g=c.payload,e=c.onSuccess,b=void 0===e?za:e;c=c.onError;c=void 0===c?za:c;f?fetch(f,{method:"POST",mode:"no-cors",headers:{"Content-Type":"application/json"},
body:g}).then(function(a){if(!a.ok&&0!==a.status)throw Error(a.status+" "+a.statusText);b(a)}).catch(c):c()},w=function(){function c(){}c.eventListeners={};c.addEventListener=function(f,g,e,b){c.setupListenerIfItDoesntExist(f,g);c.addCallbackWithPriority(f,g,e,b)};c.removeEventListener=function(f,g,e,b){c.removeCallbackWithPriority(f,g,e,b)&&c.removeListenerIfNoLongerNeeded(f,g)};c.removeListenerIfNoLongerNeeded=function(f,g){0===c.eventListeners[f][g].listeners.length&&(f.removeEventListener(g,c.eventListeners[f][g].generatedCallback),
delete c.eventListeners[f][g],Object.keys(c.eventListeners[f]).length&&delete c.eventListeners[f])};c.removeCallbackWithPriority=function(f,g,e,b){if(!c.eventListeners[f]||!c.eventListeners[f][g])return!1;c.eventListeners[f][g].listeners=c.eventListeners[f][g].listeners.filter(function(a){return a.priority!==e||a.callback!==b});return!0};c.setupListenerIfItDoesntExist=function(f,g){c.eventListeners[f]||(c.eventListeners[f]={});c.eventListeners[f][g]||(c.eventListeners[f][g]={generatedCallback:c.generateCallback(f,
g),listeners:[]},f.addEventListener(g,c.eventListeners[f][g].generatedCallback))};c.addCallbackWithPriority=function(f,g,e,b){c.eventListeners[f][g].listeners.push({callback:b,priority:e});c.eventListeners[f][g].listeners.sort(function(a,d){return a.priority-d.priority})};c.generateCallback=function(f,g){return function(e){c.eventListeners[f][g].listeners.forEach(function(b){b.callback&&b.callback(e)})}};return c}(),rb=["messageId","timestamp"],sb=function(c){var f=function(){},g=function(){var b=
function(){if(c.XDomainRequest){var a=new c.XDomainRequest;a.onerror=f;a.ontimeout=f;a.onprogress=f;a.onload=f;a.timeout=0;return a}if(c.XMLHttpRequest){a=new c.XMLHttpRequest;if(!("withCredentials"in a))throw"";return a}return null};return{isSupported:!0,send:function(a,d){if(d&&a){var h=b();if(!h)throw"";h.open("POST",a,!0);h.setRequestHeader&&h.setRequestHeader("Content-type","text/plain");h.send(d)}}}}(),e=function(){return{isSupported:!!c.navigator.sendBeacon,send:function(b,a){if(b&&a&&!c.navigator.sendBeacon(b,
a))throw"";}}}();return{ajaxClient:g,beaconClient:e}},tb=function(){return function(c,f){var g=this;this.flush=function(b){void 0===b&&(b=!1);g.eventsQueue.length&&(b||!1!==g.browserWindow.navigator.onLine)&&(b=g.eventsQueue.length,g.sendWithPriority(g.transportationClient.beaconClient,g.transportationClient.ajaxClient),g.resetBatch(),g.ueCount("EventsSent",b))};this.processEvent=function(b,a){void 0===a&&(a={n:1});var d=g.unloadHandlerCalled=!1;g.isValidAPICall(b)&&(d=g.addEvent(b,a));d?g.ueCount("ClientEventsSuccess"):
g.ueCount("ClientEventsFailed");return d};this.getEventQueueCount=function(){return g.eventsQueue.length};this.buildCompressor=function(){var b=function(n){return n.length>("#"+g.dictionaryIndex).length||"#"===n.charAt(0)},a=function(n){if(n)switch(typeof n){case "number":return!(isNaN(n)||Infinity===n)&&b(n.toString());case "boolean":break;case "string":return b(n);default:return!0}return!1},d=function(n){g.eventsDictionary[n]="#"+g.dictionaryIndex++;g.reverseEventsDictionary[g.eventsDictionary[n]]=
n;return g.eventsDictionary[n]},h=function(n){if(a(n)){var k=0;n instanceof Array?k=2:n instanceof Function?k=null:n instanceof Object&&(k=1);switch(k){case 0:return g.eventsDictionary[n]?g.eventsDictionary[n]:d(n);case 2:var q=[];for(k=0;k<n.length;k++)q[k]=h(n[k]);return q;case 1:k={};for(q in n)Object.prototype.hasOwnProperty.call(n,q)&&(k[g.eventsDictionary[q]?g.eventsDictionary[q]:d(q)]=-1===rb.indexOf(q)?h(n[q]):n[q]);return k}}return n};return{buildPOSTObject:function(){return g.stringify({cs:{dct:g.reverseEventsDictionary},
events:g.eventsQueue})},compressData:h}};this.onBeforeUnload=function(){!0!==g.unloadHandlerCalled&&(g.flush(),g.unloadHandlerCalled=!0)};this.stringify=function(b){try{return JSON.stringify(b)}catch(a){return null}};this.resetBatch=function(){g.eventsQueue=[];g.eventsDictionary={};g.reverseEventsDictionary={};g.dictionaryIndex=0;g.batchSize=0;g.lowPriorityTimer=0;g.highPriorityTimer=0};this.sendWithClient=function(b){if(null==g.endpoint||""===g.endpoint)g.ueCount("SushiClientEndpointMissing");else{if(b.isSupported){var a=
g.compressor.buildPOSTObject();return b.send(g.endpoint,a)}throw"";}};this.sendWithPriority=function(){for(var b=[],a=0;a<arguments.length;a++)b[a]=arguments[a];for(a=0;a<b.length;a++){var d=b[a];try{return g.sendWithClient(d)}catch(h){}}return null};this.startHighPriorityQueueTimer=function(){0===g.highPriorityFlushInterval?g.flush():g.highPriorityTimer||(g.highPriorityTimer=setTimeout(g.flush,g.highPriorityFlushInterval,g,!1))};this.startLowPriorityQueueTimer=function(){g.lowPriorityTimer||(g.lowPriorityTimer=
setTimeout(g.flush,g.lowPriorityFlushInterval,g,!1))};this.generateMessageId=function(b,a){return b+"-"+a+"-"+g.eventSequence};this.getCurrentISODate=function(){var b=new Date,a=function(d){return 10>d?"0"+d:d};return"function"===typeof Date.prototype.toISOString?b.toISOString():b.getUTCFullYear()+"-"+a(b.getUTCMonth()+1)+"-"+a(b.getUTCDate())+"T"+a(b.getUTCHours())+":"+a(b.getUTCMinutes())+":"+a(b.getUTCSeconds())+"."+String((b.getUTCMilliseconds()/1E3).toFixed(3)).slice(2,5)+"Z"};this.decorateEvent=
function(b){b.timestamp=g.getCurrentISODate();b.sequence=g.eventSequence;b.messageId=g.generateMessageId(b.request_id,Date.now?Date.now():(new Date).getTime())};this.startTimers=function(b){b.n?g.startHighPriorityQueueTimer():g.startLowPriorityQueueTimer()};this.encodeEvent=function(b,a,d){a=a.length;(499===g.eventsQueue.length||524288<g.batchSize+a)&&g.flush(!0);g.batchSize+=a;b={data:g.compressor.compressData(b)};g.eventsQueue.push(b);g.startTimers(d)};this.addEvent=function(b,a){g.decorateEvent(b);
var d=g.stringify(b);return d?(g.encodeEvent(b,d,a),!0):!1};this.isValidAPIParam=function(b,a){return b&&-1<b.constructor.toString().indexOf(a)};this.isMaxCallsReached=function(){g.eventSequence++;1E3<g.eventSequence&&g.ueCount("SushiClientMaxCallsReached");return 1E3<g.eventSequence};this.isValidAPICall=function(b){return!g.isMaxCallsReached()&&g.isValidAPIParam(b,"Object")};this.ueCount=function(b,a){try{var d=0===a?0:a||(y.count(g.metricsTag+":"+b)||0)+1;y.count(g.metricsTag+":"+b,d);return d}catch(h){return ua.log("SushiClient.ueCount error: "+
h,"ERROR"),0}};this.browserWindow=B().defaultView;this.endpoint=c;this.metricsTag=f;this.eventsQueue=[];this.eventsDictionary={};this.reverseEventsDictionary={};this.eventSequence=this.lowPriorityTimer=this.highPriorityTimer=this.dictionaryIndex=this.batchSize=0;this.unloadHandlerCalled=!1;this.highPriorityFlushInterval=1E3;this.lowPriorityFlushInterval=1E4;this.transportationClient=sb(this.browserWindow);this.compressor=this.buildCompressor();w.addEventListener(this.browserWindow,"beforeunload",
100,this.onBeforeUnload);w.addEventListener(B(),"visibilitychange",100,this.onBeforeUnload);w.addEventListener(this.browserWindow,"blur",100,this.onBeforeUnload);w.addEventListener(this.browserWindow,"pagehide",100,this.onBeforeUnload);this.browserWindow.app||(this.browserWindow.app={});var e=this.browserWindow.app.willDisappear;this.browserWindow.app.willDisappear=function(){e&&e();g.onBeforeUnload()}}}(),D;(function(c){c.VIEWED="VIEWED";c.PROGRESS_FIVE_SECONDS="PROGRESS_5_SEC";c.FIRST_QUARTILE=
"FIRST_QUARTILE";c.MIDPOINT="MIDPOINT";c.THIRD_QUARTILE="THIRD_QUARTILE";c.COMPLETE="COMPLETE";c.UNMUTE="UNMUTE"})(D||(D={}));var U;(function(c){c.ICON_TAP="IconTap";c.VIDEO_OFF_SCREEN="VideoOffScreen";c.INHERIT="Inherit";c.WEBKIT_MUTED="WebkitMuted"})(U||(U={}));var P;(function(c){c.ICON_TAP="IconTap";c.VIDEO_OFF_SCREEN="VideoOffScreen";c.INHERIT="Inherit";c.DEFAULT_ON="DefaultOn"})(P||(P={}));var ha;(function(c){c.SINGLE_PAGE="SINGLE_PAGE";c.CROSS_PAGE="CROSS_PAGE"})(ha||(ha={}));var V;(function(c){c.CONTENT_HASH=
"CONTENT_HASH";c.CAMPAIGN_AND_ADV_ID="CAMPAIGN_AND_ADV_ID"})(V||(V={}));var m;(function(c){c.ACE_VIDEO_RESPONSE_RECEIVED="AceVideoResponseReceived";c.AD_FEEDBACK_LOAD_FAILED_FROM_ERR="AdFeedbackLoadFailedFromErr";c.AD_FEEDBACK_LOAD_SUCCEEDED="AdFeedbackLoadSucceeded";c.AD_FEEDBACK_LOAD_POPOVER_OPENED="AdFeedbackPopoverOpened";c.AUDIO_TOGGLE_ICON_DISPLAYED="AudioToggleIconDisplayed";c.BACKGROUND_CLICKED="BackgroundClicked";c.PAUSE_ICON_DISPLAYED="PauseIconDisplayed";c.PROGRESS_BAR_DISPLAYED="ProgressBarDisplayed";
c.BRAND_LOGO_CLICKED="BrandLogoClicked";c.BRAND_CTA_LINK_CLICKED="BrandCtaLinkClicked";c.BRAND_NAME_CLICKED="BrandNameClicked";c.CREATOR_LOGO_CLICKED="CreatorLogoClicked";c.CREATOR_CTA_LINK_CLICKED="CreatorCtaLinkClicked";c.CARD_ITEM_RECEIVED="CardItemReceived";c.CAROUSEL_PAGE_CHANGED="CarouselPageChanged";c.CAPTIONS_ENABLED="CaptionsEnabled";c.CAPTIONS_DISABLED="CaptionsDisabled";c.CAPTIONS_LOAD_FAILURE="CaptionsLoadFailure";c.CTA_BANNER_CLICKED="CtaBannerClicked";c.DUPE="Dupe";c.DUPE_BY_ADVID_CAMPAIGNID=
"DupeByAdvIdCampaignId";c.DUPE_BY_CONTENT_HASH="DupeByContentHash";c.HEADLINE_CLICKED="HeadlineClicked";c.IMMERSIVE_VIDEO_FAILED="ImmersiveVideoFailed";c.IMMERSIVE_VIDEO_LOADED="ImmersiveVideoLoaded";c.MISSING_BACKGROUND_ELEMENT="MissingBackgroundElement";c.MISSING_BRAND_ELEMENT="MissingBrandElement";c.MISSING_PRODUCT_ELEMENT="MissingProductElement";c.MISSING_PRODUCT_ELEMENTS="MissingProductElements";c.MISSING_VIDEO_ELEMENT="MissingVideoElement";c.MISSING_CREATOR_ELEMENT="MissingCreatorElement";c.NO_AD_ERROR=
"NoAdError";c.NO_VIDEO_SRC_ON_ELEMENT="NoVideoSrcOnElement";c.NUMBER_OF_ADS_LESS_THAN_MIN_ERR="NumberOfAdsLessThanMin";c.PLAYBACK_COMPLETED="PlaybackCompleted";c.PROGRESS_BAR_RESET="ProgressBarReset";c.PLAYBACK_FAILED_TO_START_AFTER_PLAY="PlaybackFailedToStartAfterPlay";c.PRODUCT_CLICKED="ProductClicked";c.PRODUCT_RECEIVED="ProductReceived";c.PRODUCT_TWISTER_VARIATION="ProductTwisterVariation";c.MULTI_PRODUCT_COLLECTION="MultiProductCollection";c.REMOTE_OPERATIONS_AJAX_STARTED="RemoteOperationsAjaxStarted";
c.REMOTE_OPERATIONS_AJAX_SUCCESSFUL="RemoteOperationsAjaxSuccessful";c.REMOTE_OPERATIONS_ELEMENTS_UPDATED="RemoteOperationsElementsUpdated";c.REMOTE_OPERATIONS_ELEMENTS_NOT_UPDATED="RemoteOperationsElementsNotUpdated";c.REMOTE_OPERATIONS_FAILED="RemoteOperationsFailed";c.TIME_TO_FIRST_FRAME="TimeToFirstFrame";c.VIDEO_ABORTED="VideoAborted";c.VIDEO_BUFFERING_ENDED="VideoBufferingEnded";c.VIDEO_BUFFERING_STARTED="VideoBufferingStarted";c.VIDEO_CLEARED_ON_HIDDEN_BROWSER="VideoClearedOnHiddenBrowser";
c.VIDEO_CLICKED="VideoClicked";c.VIDEO_DURATION_PLAYED="VideoDurationPlayed";c.VIDEO_LOADED_ON_VISIBLE_BROWSER="VideoLoadedOnVisibleBrowser";c.VIDEO_OFF_SCREEN="VideoOffScreen";c.VIDEO_ON_SCREEN="VideoOnScreen";c.VIDEO_PAUSED="VideoPaused";c.VIDEO_PAUSED_INITIATED="VideoPausedInitiated";c.VIDEO_PAUSE_BUTTON_TRIGGERED="VideoPauseButtonTriggered";c.VIDEO_PLAY_BUTTON_TRIGGERED="VideoPlayButtonTriggered";c.VIDEO_PLAY_FROM_PAUSE="VideoPlayFromPause";c.VIDEO_PAUSED_ON_AUTOPLAY_DISABLED="VideoPausedOnAutoplayDisabled";
c.VIDEO_PLAYBACK_FAILURE="VideoPlaybackFailure";c.VIDEO_PLAYBACK_INITIATED="VideoPlaybackInitiated";c.VIDEO_PLAYBACK_STARTED="VideoPlaybackStarted";c.VIDEO_PLAY_PROMISE_NOT_SUPPORTED="VideoPlayPromiseNotSupported";c.VIDEO_PREVIEW_IMAGE_NOT_MEDIA_AMAZON="VideoPreviewImageNotMediaAmazon";c.VIDEO_PLAY_PROMISE_REJECTED="VideoPlayPromiseRejected";c.VIDEO_READY_FOR_PLAYBACK="VideoReadyForPlayback";c.VIDEO_SOUND_OFF="VideoSoundOff";c.VIDEO_SOUND_ON="VideoSoundOn";c.VIDEO_SUSPENDED="VideoSuspended";c.VIDEO_VIEW=
"VideoView";c.VM_AD_UNIT_VIEWED="ViewMetricsAdUnitViewed";c.VM_VIDEO_VIEWED="ViewMetricsVideoViewed";c.VM_VIDEO_PROGRESS_FIVE_SECONDS="ViewMetricsVideoProgressFiveSeconds";c.VM_VIDEO_FIRST_QUARTILE="ViewMetricsVideoFirstQuartile";c.VM_VIDEO_MIDPOINT="ViewMetricsVideoMidpoint";c.VM_VIDEO_THIRD_QUARTILE="ViewMetricsVideoThirdQuartile";c.VM_VIDEO_COMPLETE="ViewMetricsVideoComplete";c.VM_VIDEO_UNMUTE="ViewMetricsVideoUnmute";c.VM_POST_FAILURE="ViewMetricsPostFailure";c.WIDGET_ON_SCREEN="WidgetOnScreen";
c.MULTI_ASIN_ADS_RECEIVED="MultiAsinAdsReceived";c.PDP_RENDERED_AS_PC="PDPRenderedAsPC";c.HLS_VIDEO_RENDERED="HLSVideoRendered"})(m||(m={}));var l;(function(c){c.APP_VERSION="appVersion";c.ADVERTISER_ID="advertiserId";c.AUTO_SCROLLED="autoScrolled";c.CAMPAIGN_ID="campaignId";c.CAROUSEL_ITEM_INDEX="carouselItemIndex";c.CAROUSEL_PAGE_NUMBER="carouselPageNumber";c.CC_TOGGLE_CAUSE="ccToggleCause";c.CC_MANDATORY="ccMandatory";c.CC_SRC="ccSrc";c.CLIENT_ID="clientId";c.CONTINUOUS_PLAYBACK_DURATION_MS="continuousPlaybackDurationMs";
c.CURRENT_PAGE_URL="currentPageUrl";c.DEVICE_ENV="deviceEnv";c.DEVICE_MAKE="deviceMake";c.DEVICE_MODEL="deviceModel";c.DEVICE_OS="deviceOs";c.DEVICE_PLATFORM_VERSION="devicePlatformVersion";c.DEVICE_TYPE="deviceType";c.DROPPED_FRAMES="droppedFrames";c.ERROR_CODE="errorCode";c.ERROR_MESSAGE="errorMessage";c.EVENT_TYPE="eventType";c.EXPERIENCE="experience";c.EXPERIENCE_VARIATION="experienceVariation";c.HEADLINE="headline";c.IMAGE_URL="imageUrl";c.LANGUAGE="language";c.LINK_URL="linkUrl";c.LOAD_TIME_MS=
"loadTimeMs";c.LOGIC="logic";c.MARKETPLACE_ID="marketplaceId";c.METRICS_IDENTIFIER="metricsIdentifier";c.METRICS_SEQUENCE_NUMBER="metricsSequenceNumber";c.NETWORK_TYPE="networkType";c.NUMBER_OF_ADS="numberOfAds";c.PAGE_NUMBER="pageNumber";c.PAGE_TYPE="pageType";c.PERCENT_DOWNLOADED="percentDownloaded";c.PREV_CAROUSEL_PAGE_NUMBER="prevCarouselPageNumber";c.PRODUCT_COMPONENTS="productComponents";c.PRODUCT_INDEX="productIndex";c.PRODUCT_ASIN="asin";c.TWISTER_VARIATIONS_REQUESTED="twisterVariationsRequested";
c.TWISTER_VARIATIONS_REQUEST_SUCCEEDED="twisterVariationsRequestSuceeded";c.TWISTER_VARIATIONS_DETAIL_REQUESTED="twisterVariationsDetailRequested";c.TWISTER_VARIATIONS_CHOSEN="twisterVariationsChosen";c.NUMBER_OF_TWISTER_VARIATIONS_RECEIVED="numberOfTwisterVariationsReceived";c.REASON="reason";c.RETRY_COUNT="retryCount";c.SEARCH_QUERY="searchQuery";c.SOUND_TOGGLE_METHOD="soundToggleMethod";c.STAGE="stage";c.STATUS_CODE="statusCode";c.STORE_CTA="storeCta";c.STORE_NAME="storeName";c.STORE_URL="storeUrl";
c.TIME_ON_SCREEN_MS="timeOnScreenMs";c.USER_AGENT="userAgent";c.VIDEO_BOUNDARY_CROSSED_TIME_MS="videoBoundaryCrossedTimeMs";c.VIDEO_CURRENT_TIME_MS="videoCurrentTimeMs";c.VIDEO_ORIENTATION="videoOrientation";c.VIDEO_PREVIEW_IMAGE_SRC="videoPreviewImageSrc";c.VIDEO_SRC="videoSrc";c.VIDEO_TOTAL_LENGTH_MS="videoTotalLengthMs";c.VIDEO_TYPE="videoType";c.WAS_BUFFERING="wasBuffering";c.WEBLABS="weblabs";c.WIDGET_GROUP_ID="widgetGroupId";c.WIDGET_INDEX="widgetIndex";c.WIDGET_TYPE="widgetType";c.VIEW_METRICS_FAILURE=
"viewMetricsFailure";c.MULTI_ASIN_ADS_COUNT="MultiAsinAdsCount";c.HLS_VIDEO_SRC="hlsVideoSrc"})(l||(l={}));var Aa={shouldLogViewMetrics:!1,shouldBillViewMetrics:!0,shouldLogAdUnitViewMetrics:!1},ub=function(){return function(c,f,g){var e=this;void 0===g&&(g=Aa);this.reportPDPRenderedAsPC=function(b){b=e.newEvent(m.PDP_RENDERED_AS_PC,b);e.recordEvent(b)};this.reportHLSVideoRendered=function(b){b=e.newEvent(m.HLS_VIDEO_RENDERED,b);e.recordEvent(b)};this.setClientMetricsContext=function(b){e.clientMetricsContext=
b};this.reportWidgetOnScreen=function(){var b=e.newEvent(m.WIDGET_ON_SCREEN,e.resetVideoAdAttributes());e.recordEvent(b)};this.reportResponseReceived=function(b){var a=e.newEvent(m.ACE_VIDEO_RESPONSE_RECEIVED,e.resetVideoAdAttributes());a[l.NUMBER_OF_ADS]=null!==b&&void 0!==b?b:1;e.recordEvent(a)};this.reportNumAsins=function(b){var a=e.newEvent(m.MULTI_ASIN_ADS_RECEIVED);a[l.MULTI_ASIN_ADS_COUNT]=b;e.recordEvent(a)};this.reportNoAdError=function(){var b=e.newEvent(m.NO_AD_ERROR,e.resetVideoAdAttributes());
e.recordEvent(b)};this.reportNumOfAdsLessThanMinRequirement=function(){var b=e.newEvent(m.NUMBER_OF_ADS_LESS_THAN_MIN_ERR,e.resetVideoAdAttributes());e.recordEvent(b)};this.reportAdFeedbackLoadFailedFromErr=function(b){var a=e.newEvent(m.AD_FEEDBACK_LOAD_FAILED_FROM_ERR,e.resetVideoAdAttributes());a[l.ERROR_MESSAGE]=b;e.recordEvent(a)};this.reportAdFeedbackLoadSucceeded=function(){var b=e.newEvent(m.AD_FEEDBACK_LOAD_SUCCEEDED,e.resetVideoAdAttributes());e.recordEvent(b)};this.reportAdFeedbackPopoverOpened=
function(){var b=e.newEvent(m.AD_FEEDBACK_LOAD_POPOVER_OPENED,e.resetVideoAdAttributes());e.recordEvent(b)};this.reportImmersiveVideoLoaded=function(b){b=e.newEvent(m.IMMERSIVE_VIDEO_LOADED,b);e.recordEvent(b)};this.reportImmersiveVideoFailed=function(b,a){a=e.newEvent(m.IMMERSIVE_VIDEO_FAILED,a);a[l.ERROR_MESSAGE]=b;e.recordEvent(a)};this.reportVideoReadyForPlayback=function(b,a,d,h,n){var k=e.newEvent(m.VIDEO_READY_FOR_PLAYBACK,h);k[l.LOAD_TIME_MS]=b;k[l.RETRY_COUNT]=a;k[l.PERCENT_DOWNLOADED]=d;
k[l.VIDEO_TOTAL_LENGTH_MS]=n;k[l.VIDEO_ORIENTATION]=h.videoOrientation;e.recordEvent(k)};this.reportVideoPlaybackInitiated=function(b,a){a=e.newEvent(m.VIDEO_PLAYBACK_INITIATED,a);a[l.VIDEO_CURRENT_TIME_MS]=b;e.recordEvent(a)};this.reportVideoPlaybackStarted=function(b,a,d,h){h=e.newEvent(m.VIDEO_PLAYBACK_STARTED,h);h[l.VIDEO_CURRENT_TIME_MS]=b;h[l.PERCENT_DOWNLOADED]=a;h[l.DROPPED_FRAMES]=d;e.recordEvent(h)};this.reportTimeToFirstFrame=function(b,a,d,h){h=e.newEvent(m.TIME_TO_FIRST_FRAME,h);h[l.LOAD_TIME_MS]=
b;h[l.PERCENT_DOWNLOADED]=a;h[l.DROPPED_FRAMES]=d;e.recordEvent(h)};this.reportVideoBufferingStarted=function(b,a,d,h){h=e.newEvent(m.VIDEO_BUFFERING_STARTED,h);h[l.VIDEO_CURRENT_TIME_MS]=b;h[l.PERCENT_DOWNLOADED]=a;h[l.DROPPED_FRAMES]=d;e.recordEvent(h)};this.reportVideoBufferingEnded=function(b,a,d,h){h=e.newEvent(m.VIDEO_BUFFERING_ENDED,h);h[l.VIDEO_CURRENT_TIME_MS]=b;h[l.PERCENT_DOWNLOADED]=a;h[l.DROPPED_FRAMES]=d;e.recordEvent(h)};this.reportVideoPlaybackFailure=function(b,a,d,h){h=e.newEvent(m.VIDEO_PLAYBACK_FAILURE,
h);h[l.VIDEO_CURRENT_TIME_MS]=b;h[l.ERROR_MESSAGE]=a;h[l.ERROR_CODE]=d;e.recordEvent(h)};this.reportVideoDurationPlayed=function(b,a,d,h){h=e.newEvent(m.VIDEO_DURATION_PLAYED,h);h[l.VIDEO_BOUNDARY_CROSSED_TIME_MS]=b;h[l.PERCENT_DOWNLOADED]=a;h[l.DROPPED_FRAMES]=d;e.recordEvent(h)};this.reportPlaybackCompleted=function(b,a,d){d=e.newEvent(m.PLAYBACK_COMPLETED,d);d[l.VIDEO_CURRENT_TIME_MS]=b;d[l.DROPPED_FRAMES]=a;e.recordEvent(d)};this.reportVideoOnScreen=function(b,a){a=e.newEvent(m.VIDEO_ON_SCREEN,
a);a[l.PERCENT_DOWNLOADED]=b;e.recordEvent(a)};this.reportVideoClearedOnHiddenBrowser=function(b){b=e.newEvent(m.VIDEO_CLEARED_ON_HIDDEN_BROWSER,b);e.recordEvent(b)};this.reportVideoLoadedOnVisibleBrowser=function(b){b=e.newEvent(m.VIDEO_LOADED_ON_VISIBLE_BROWSER,b);e.recordEvent(b)};this.reportVideoOffScreen=function(b,a,d,h){h=e.newEvent(m.VIDEO_OFF_SCREEN,h);h[l.TIME_ON_SCREEN_MS]=b;h[l.WAS_BUFFERING]=a;h[l.VIDEO_CURRENT_TIME_MS]=d;e.recordEvent(h)};this.reportVideoView=function(b,a,d){void 0===
a&&(a=!1);d=e.newEvent(m.VIDEO_VIEW,d);d[l.CONTINUOUS_PLAYBACK_DURATION_MS]=b;e.recordEvent(d);a&&e.sushiClient.flush(!0)};this.reportVideoPauseInitiated=function(b,a){a=e.newEvent(m.VIDEO_PAUSED_INITIATED,a);a[l.VIDEO_CURRENT_TIME_MS]=b;e.recordEvent(a)};this.reportVideoPlayFromPause=function(b,a){a=e.newEvent(m.VIDEO_PLAY_FROM_PAUSE,a);a[l.VIDEO_CURRENT_TIME_MS]=b;e.recordEvent(a)};this.reportVideoPaused=function(b,a,d,h){h=e.newEvent(m.VIDEO_PAUSED,h);h[l.VIDEO_CURRENT_TIME_MS]=b;h[l.PERCENT_DOWNLOADED]=
a;h[l.DROPPED_FRAMES]=d;e.recordEvent(h)};this.reportVideoSoundOn=function(b,a,d){d=e.newEvent(m.VIDEO_SOUND_ON,d);d[l.VIDEO_CURRENT_TIME_MS]=b;d[l.SOUND_TOGGLE_METHOD]=a;e.recordEvent(d)};this.reportVideoSoundOff=function(b,a,d){d=e.newEvent(m.VIDEO_SOUND_OFF,d);d[l.VIDEO_CURRENT_TIME_MS]=b;d[l.SOUND_TOGGLE_METHOD]=a;e.recordEvent(d)};this.reportCaptionsOn=function(b,a,d,h){a=e.newEvent(m.CAPTIONS_ENABLED,a);a[l.LANGUAGE]=d;a[l.CC_MANDATORY]=h;a[l.CC_TOGGLE_CAUSE]=b;e.recordEvent(a)};this.reportCaptionsOff=
function(b,a,d,h){a=e.newEvent(m.CAPTIONS_DISABLED,a);a[l.LANGUAGE]=d;a[l.CC_MANDATORY]=h;a[l.CC_TOGGLE_CAUSE]=b;e.recordEvent(a)};this.reportCaptionsLoadFailure=function(b){var a=e.newEvent(m.CAPTIONS_LOAD_FAILURE,b);a[l.CC_SRC]=b.ccSrc;e.recordEvent(a)};this.reportDupe=function(b,a,d){b=e.newEvent(m.DUPE,b);b[l.LOGIC]=a;b[l.REASON]=d;e.recordEvent(b)};this.reportDupeByCampaignAndAdvertiserId=function(b){b=e.newEvent(m.DUPE_BY_ADVID_CAMPAIGNID,b);e.recordEvent(b)};this.reportDupeByContentHash=function(b){b=
e.newEvent(m.DUPE_BY_CONTENT_HASH,b);e.recordEvent(b)};this.reportVideoClicked=function(b,a){a=e.newEvent(m.VIDEO_CLICKED,a,e.getDynamicMetricsAttributes());a[l.VIDEO_CURRENT_TIME_MS]=b;e.recordEvent(a)};this.reportProductClicked=function(b,a,d){a=e.newEvent(m.PRODUCT_CLICKED,a,e.getDynamicMetricsAttributes());a[l.VIDEO_CURRENT_TIME_MS]=b;if(d){b=d.productComponents;var h=d.productIndex;a[l.PRODUCT_ASIN]=d.asin;a[l.PRODUCT_INDEX]=h;a[l.PRODUCT_COMPONENTS]=b}e.recordEvent(a)};this.reportBackgroundClicked=
function(b,a){a=e.newEvent(m.BACKGROUND_CLICKED,a,e.getDynamicMetricsAttributes());a[l.VIDEO_CURRENT_TIME_MS]=b;e.recordEvent(a)};this.reportProductReceived=function(b,a,d){a=e.newEvent(m.PRODUCT_RECEIVED,a,e.getDynamicMetricsAttributes());a[l.VIDEO_CURRENT_TIME_MS]=b;if(d){b=d.productComponents;var h=d.productIndex;a[l.PRODUCT_ASIN]=d.asin;a[l.PRODUCT_COMPONENTS]=b;a[l.PRODUCT_INDEX]=h}e.recordEvent(a)};this.reportProductTwisterVariations=function(b,a){b=e.newEvent(m.PRODUCT_TWISTER_VARIATION,b);
if(a&&a.twisterVariationProperties){var d=a.twisterVariationProperties;a=d.twisterVariationsRequested;var h=d.twisterVariationsRequestSucceeded,n=d.twisterVariationDetailsRequested,k=d.numberOfTwisterVariationsAvailable;d=d.asinForTwisterChosen;b[l.TWISTER_VARIATIONS_REQUESTED]=null!==a&&void 0!==a?a:!1;b[l.TWISTER_VARIATIONS_REQUEST_SUCCEEDED]=null!==h&&void 0!==h?h:!1;b[l.NUMBER_OF_TWISTER_VARIATIONS_RECEIVED]=k;b[l.TWISTER_VARIATIONS_DETAIL_REQUESTED]=null!==n&&void 0!==n?n:!1;b[l.TWISTER_VARIATIONS_CHOSEN]=
d}e.recordEvent(b)};this.reportProductAttributes=function(b,a){b=e.newEvent(m.MULTI_PRODUCT_COLLECTION,b);if(a){var d=a.productUrl;b[l.PRODUCT_ASIN]=a.asin;b[l.LINK_URL]=d}e.recordEvent(b)};this.reportPlaybackFailedToStartAfterPlay=function(b){b=e.newEvent(m.PLAYBACK_FAILED_TO_START_AFTER_PLAY,b);e.recordEvent(b)};this.reportAudioToggleIconDisplayed=function(b){b=e.newEvent(m.AUDIO_TOGGLE_ICON_DISPLAYED,b);e.recordEvent(b)};this.reportProgressBarDisplayed=function(b){b=e.newEvent(m.PROGRESS_BAR_DISPLAYED,
b);e.recordEvent(b)};this.reportProgressBarReset=function(b){b=e.newEvent(m.PROGRESS_BAR_RESET,b);e.recordEvent(b)};this.reportPauseIconDisplayed=function(b){b=e.newEvent(m.PAUSE_ICON_DISPLAYED,b);e.recordEvent(b)};this.reportVideoPauseButtonTriggered=function(b,a){a=e.newEvent(m.VIDEO_PAUSE_BUTTON_TRIGGERED,a);a[l.VIDEO_CURRENT_TIME_MS]=b;e.recordEvent(a)};this.reportVideoPausedOnAutoplayDisabled=function(b){b=e.newEvent(m.VIDEO_PAUSED_ON_AUTOPLAY_DISABLED,b);e.recordEvent(b)};this.reportVideoAborted=
function(b,a){a=e.newEvent(m.VIDEO_ABORTED,a);a[l.VIDEO_CURRENT_TIME_MS]=b;e.recordEvent(a)};this.reportVideoSuspended=function(b,a){a=e.newEvent(m.VIDEO_SUSPENDED,a);a[l.VIDEO_CURRENT_TIME_MS]=b;e.recordEvent(a)};this.reportVideoPlayPromiseRejected=function(b,a){a=e.newEvent(m.VIDEO_PLAY_PROMISE_REJECTED,a);a[l.ERROR_MESSAGE]=b;e.recordEvent(a)};this.reportVideoPreviewImageNotMediaAmazon=function(b){b=e.newEvent(m.VIDEO_PREVIEW_IMAGE_NOT_MEDIA_AMAZON,b);e.recordEvent(b)};this.reportVideoPlayPromiseNotSupported=
function(b){b=e.newEvent(m.VIDEO_PLAY_PROMISE_NOT_SUPPORTED,b);e.recordEvent(b)};this.reportMissingVideoElement=function(b){b=e.newEvent(m.MISSING_VIDEO_ELEMENT,b);e.recordEvent(b)};this.reportMissingProductElement=function(b){b=e.newEvent(m.MISSING_PRODUCT_ELEMENT,b);e.recordEvent(b)};this.reportMissingProductElements=function(b){b=e.newEvent(m.MISSING_PRODUCT_ELEMENTS,b);e.recordEvent(b)};this.reportMissingBackgroundElement=function(b){b=e.newEvent(m.MISSING_BACKGROUND_ELEMENT,b);e.recordEvent(b)};
this.reportMissingBrandElement=function(b,a){var d,h,n;b=e.newEvent(m.MISSING_BRAND_ELEMENT,b);b[l.STORE_NAME]=null!==(d=null===a||void 0===a?void 0:a.storeName)&&void 0!==d?d:void 0;b[l.STORE_URL]=null!==(h=null===a||void 0===a?void 0:a.storeUrl)&&void 0!==h?h:void 0;b[l.STORE_CTA]=null!==(n=null===a||void 0===a?void 0:a.storeCta)&&void 0!==n?n:void 0;e.recordEvent(b)};this.reportBrandCtaLinkClicked=function(b,a){a=e.newEvent(m.BRAND_CTA_LINK_CLICKED,a);a[l.VIDEO_CURRENT_TIME_MS]=b;e.recordEvent(a)};
this.reportBrandLogoClicked=function(b,a){a=e.newEvent(m.BRAND_LOGO_CLICKED,a);a[l.VIDEO_CURRENT_TIME_MS]=b;e.recordEvent(a)};this.reportBrandNameClicked=function(b,a){a=e.newEvent(m.BRAND_NAME_CLICKED,a);a[l.VIDEO_CURRENT_TIME_MS]=b;e.recordEvent(a)};this.reportCreatorLogoClicked=function(b,a){a=e.newEvent(m.CREATOR_LOGO_CLICKED,a);a[l.VIDEO_CURRENT_TIME_MS]=b;e.recordEvent(a)};this.reportCreatorCtaClicked=function(b,a){a=e.newEvent(m.CREATOR_CTA_LINK_CLICKED,a);a[l.VIDEO_CURRENT_TIME_MS]=b;e.recordEvent(a)};
this.reportCtaBannerClicked=function(b,a){a=e.newEvent(m.CTA_BANNER_CLICKED,a);a[l.VIDEO_CURRENT_TIME_MS]=b;e.recordEvent(a)};this.reportHeadlineClicked=function(b,a){a=e.newEvent(m.HEADLINE_CLICKED,a);a[l.VIDEO_CURRENT_TIME_MS]=b;e.recordEvent(a)};this.reportMissingCreatorElement=function(b){b=e.newEvent(m.MISSING_CREATOR_ELEMENT,b);e.recordEvent(b)};this.reportCarouselPageChanged=function(b,a,d){void 0===d&&(d=!1);var h=e.newEvent(m.CAROUSEL_PAGE_CHANGED);h[l.CAROUSEL_PAGE_NUMBER]=b;h[l.PREV_CAROUSEL_PAGE_NUMBER]=
a;h[l.AUTO_SCROLLED]=d;e.recordEvent(h)};this.reportCardItemReceived=function(b,a){a=e.newEvent(m.CARD_ITEM_RECEIVED,a);a[l.CAROUSEL_PAGE_NUMBER]=b;e.recordEvent(a)};this.reportVideoPlayButtonTriggered=function(b,a){a=e.newEvent(m.VIDEO_PLAY_BUTTON_TRIGGERED,a);a[l.CAROUSEL_ITEM_INDEX]=b;e.recordEvent(a)};this.reportRemoteOperationsAjaxStarted=function(){var b=e.newEvent(m.REMOTE_OPERATIONS_AJAX_STARTED);e.recordEvent(b)};this.reportRemoteOperationsAjaxSuccessful=function(b){var a=e.newEvent(m.REMOTE_OPERATIONS_AJAX_SUCCESSFUL);
a[l.LOAD_TIME_MS]=b;e.recordEvent(a)};this.reportRemoteOperationsElementsUpdated=function(){var b=e.newEvent(m.REMOTE_OPERATIONS_ELEMENTS_UPDATED);e.recordEvent(b)};this.reportRemoteOperationsElementsNotUpdated=function(){var b=e.newEvent(m.REMOTE_OPERATIONS_ELEMENTS_NOT_UPDATED);e.recordEvent(b)};this.reportRemoteOperationsFailed=function(){var b=e.newEvent(m.REMOTE_OPERATIONS_FAILED);e.recordEvent(b)};this.reportViewMetricsAdUnitViewed=function(b,a,d){if(e.getShouldLogViewMetrics()&&e.getShouldLogAdUnitViewMetrics()){var h=
e.newEvent(m.VM_AD_UNIT_VIEWED,b);e.recordEvent(h);a={p:Math.round(100*d),t:parseFloat((a/1E3).toFixed(3))};e.emitViewMetrics(D.VIEWED,b,a)}};this.reportViewMetricsVideoViewed=function(b,a,d){if(e.getShouldLogViewMetrics()){var h=e.newEvent(m.VM_VIDEO_VIEWED,b);e.recordEvent(h);e.getShouldLogAdUnitViewMetrics()||(a={p:Math.round(100*d),t:parseFloat((a/1E3).toFixed(3))},e.emitViewMetrics(D.VIEWED,b,a))}};this.reportViewMetricsVideoProgressFiveSeconds=function(b){if(e.getShouldLogViewMetrics()){var a=
e.newEvent(m.VM_VIDEO_PROGRESS_FIVE_SECONDS,b);e.recordEvent(a);e.emitViewMetrics(D.PROGRESS_FIVE_SECONDS,b)}};this.reportViewMetricsVideoFirstQuartile=function(b){if(e.getShouldLogViewMetrics()){var a=e.newEvent(m.VM_VIDEO_FIRST_QUARTILE,b);e.recordEvent(a);e.emitViewMetrics(D.FIRST_QUARTILE,b)}};this.reportViewMetricsVideoMidpoint=function(b){if(e.getShouldLogViewMetrics()){var a=e.newEvent(m.VM_VIDEO_MIDPOINT,b);e.recordEvent(a);e.emitViewMetrics(D.MIDPOINT,b)}};this.reportViewMetricsVideoThirdQuartile=
function(b){if(e.getShouldLogViewMetrics()){var a=e.newEvent(m.VM_VIDEO_THIRD_QUARTILE,b);e.recordEvent(a);e.emitViewMetrics(D.THIRD_QUARTILE,b)}};this.reportViewMetricsVideoComplete=function(b){if(e.getShouldLogViewMetrics()){var a=e.newEvent(m.VM_VIDEO_COMPLETE,b);e.recordEvent(a);e.emitViewMetrics(D.COMPLETE,b)}};this.reportViewMetricsVideoUnmute=function(b){if(e.getShouldLogViewMetrics()){var a=e.newEvent(m.VM_VIDEO_UNMUTE,b);e.recordEvent(a);e.emitViewMetrics(D.UNMUTE,b)}};this.reportViewMetricsPostRequestFailure=
function(b,a,d){d=e.newEvent(m.VM_POST_FAILURE,d);d[l.VIEW_METRICS_FAILURE]=b;d[l.ERROR_MESSAGE]=a;e.recordEvent(d)};this.emitViewMetrics=function(b,a,d){void 0===d&&(d={});if(e.getShouldBillViewMetrics()){var h=a.instrumentationPixelUrl;void 0===h||""===h?e.reportViewMetricsPostRequestFailure(b,"instrumentationPixelUrl is empty or undefined",a):(d=JSON.stringify({v:p.__assign(p.__assign({},d),{def:"iab",event:b}),programType:"SBV"}),h="/"===h.substr(-1)?h+"v/":h+"/v/",qb({onError:function(n){e.reportViewMetricsPostRequestFailure(b,
n.message,a)},payload:d,url:h+encodeURI(d)}))}};this.getShouldLogViewMetrics=function(){return e.viewMetricOptions.shouldLogViewMetrics};this.getShouldLogAdUnitViewMetrics=function(){return e.viewMetricOptions.shouldLogAdUnitViewMetrics};this.getShouldBillViewMetrics=function(){return e.viewMetricOptions.shouldLogViewMetrics&&e.viewMetricOptions.shouldBillViewMetrics};this.recordEvent=function(b){e.sushiClient.processEvent(b)};this.resetVideoAdAttributes=function(){return{advertiserId:void 0,campaignId:void 0,
contentHash:void 0,headline:void 0,storeCta:void 0,imageUrl:void 0,instrumentationPixelUrl:void 0,linkUrl:void 0,metricsIdentifier:void 0,videoPreviewImageSrc:void 0,videoSrc:void 0,hlsVideoSrc:void 0}};this.getDynamicMetricsAttributes=function(){var b,a;return null===(a=null===(b=e.clientMetricsContext)||void 0===b?void 0:b.getDynamicMetricsAttributes)||void 0===a?void 0:a.call(b)};this.newEvent=function(b,a,d){void 0===d&&(d={});a=p.__assign(p.__assign(p.__assign({},e.defaultAttributes),a),d);a[l.EVENT_TYPE]=
b;a[l.METRICS_SEQUENCE_NUMBER]=e.metricsSequenceNumber++;a[l.NETWORK_TYPE]=navigator&&navigator.connection&&navigator.connection.type;return a};this.browserWindow=B().defaultView;this.metricsSequenceNumber=0;this.sushiClient=new tb(f,"SBVClientMetrics");this.defaultAttributes=p.__assign({},c);this.defaultAttributes[l.USER_AGENT]=navigator.userAgent;this.viewMetricOptions=p.__assign(p.__assign({},Aa),g);(f=this.browserWindow&&this.browserWindow.location&&this.browserWindow.location.href)&&(this.defaultAttributes[l.CURRENT_PAGE_URL]=
f);c.pageNumber&&(c=parseInt(c.pageNumber,10),isNaN(c)||(this.defaultAttributes[l.PAGE_NUMBER]=c))}}(),vb=function(c){try{var f=encodeURIComponent,g=JSON,e=g.stringify,b=JSON.parse(c);var a={adCreativeMetaData:{adId:b.feedbackRequestAdId,advertiserId:b.feedbackRequestAdvertiserId,adNetwork:"aax",adProgramId:1010,adCreativeDetails:[{advertiserIdNS:b.feedbackRequestAdvertiserIdNS,campaignId:b.feedbackRequestCampaignId,selectionSignals:Ba(b.feedbackRequestSelectionSignals)}]},adPlacementMetaData:{adElementId:b.adElementId,
pageType:b.pageType,slotName:b.slotName}};return"/af/feedback-link?pl="+f(e.call(g,a))}catch(d){return null}},ia=function(){var c=T('[data-id="afb-sponsored"]');c&&(c.style.display="block")},yb=function(c,f){return p.__awaiter(void 0,void 0,void 0,function(){var g,e,b,a;return p.__generator(this,function(d){switch(d.label){case 0:g=f.cardName;e=f.isAdFeedbackForCards;if(!e)return[3,1];wb(f).then(function(){c.reportAdFeedbackLoadSucceeded()}).catch(function(h){c.reportAdFeedbackLoadFailedFromErr(h.message||
"")});return[3,4];case 1:return d.trys.push([1,3,,4]),[4,xb()];case 2:return d.sent(),c.reportAdFeedbackLoadSucceeded(),(b=A["default"].cardRoot.querySelector('[data-id="afb-content"]'))?b.querySelectorAll("a").forEach(function(h){h.addEventListener("click",c.reportAdFeedbackPopoverOpened)}):y.count(g+"-AdfeedbackElementNotFound"),[3,4];case 3:return a=d.sent(),c.reportAdFeedbackLoadFailedFromErr(a.message||""),[3,4];case 4:return[2]}})})},wb=function(c){return p.__awaiter(void 0,void 0,void 0,function(){var f,
g,e,b,a;return p.__generator(this,function(d){switch(d.label){case 0:f=fa("data-ad-feedback");g=fa("data-ad-feedback-label-id");e=c.enableAdFeedback;if(!f||!g)return[2,Promise.reject(Error("data-ad-feedback attributes not found"))];b=JSON.parse(f);a=function(){return{adFeedbackLabelId:g,adCreativeMetaData:{adCreativeDetails:b.creativeDetails.map(function(h,n){var k=h.adId,q=h.advertiserId,r=h.advertiserIdNS,u=h.campaignId,v=Ba(h.selectionSignals),x=h.title;(h=h.imageUrl)?(h={url:h,width:0,height:0},
h={lowResolutionImage:h,highResolutionImages:[h]}):h=void 0;return{adId:k,advertiserId:q,adCreativeIndex:n,adNetwork:"aax",advertiserIdNS:r,campaignId:u,selectionSignals:v,title:x,adCreativeImage:h}})}}};d.label=1;case 1:return d.trys.push([1,3,,4]),[4,e(a)];case 2:return d.sent(),[3,4];case 3:return d.sent(),[2,Promise.reject(Error("enableAdFeedbackClient call failed"))];case 4:return[2,Promise.resolve("success")]}})})},xb=function(){var c=fa("data-ad-feedback");if(c){var f=vb(c);return new Promise(function(g,
e){pb({url:f,onSuccess:function(b){try{var a=b.html,d=T('[data-id="afb-content"]');if(d&&a){var h=T('[data-id="afb-sponsored"]');h&&(h.style.display="none");d.innerHTML=a}var n=b.script;if(n){var k=B().createElement("script");k.type="text/javascript";k.innerHTML=n;T().appendChild(k)}}catch(q){ia(),e(Error("setHtml or setScript failed"))}g("success")},onError:function(){ia();e(Error("get ad feedback request failed"))}})})}return Promise.reject(Error("data-ad-feedback attributes not found"))},Ba=function(c){var f;
if(c){switch(null===(f=c.pastActivity)||void 0===f?void 0:f.toUpperCase()){case "STORE_ONLY":f=1;break;case "AMAZON_AND_OTHER":f=3;break;case "AMAZON_ONLY":f=2;break;default:f=0}return p.__assign(p.__assign({},c),{pastActivity:f})}},zb=function(c){var f=xa.getStage();switch(c){default:return"https://unagi-na.amazon.com/1/events/com.amazon.eel.sbv.client."+f+".events";case "A1F83G8C2ARO7P":case "A1PA6795UKMFR9":case "A13V1IB3VIYZZH":case "APJ6JRA9NG5V4":case "A3HOBANJMCMD83":case "A1RKKUPIHCS9HS":case "AJZF8LZ1EJVJN":case "A21TJRUUN4KGV":case "A2XZLSVIQ0F4JT":return"https://unagi-eu.amazon.com/1/events/com.amazon.eel.sbv.client."+
f+".eu";case "A1VC38T7YXB528":return"https://unagi-fe.amazon.com/1/events/com.amazon.eel.sbv.client."+f+".fe"}},J=function(){function c(){}c.navigatorInternal=navigator;c.isIOS=function(){return t["default"].capabilities.ios};c.isIOSWebView=function(){return t["default"].capabilities.isAmazonApp&&t["default"].capabilities.ios};c.isWebView=function(){return t["default"].capabilities.isAmazonApp};c.isSafari=function(){return!(!c.navigatorInternal.vendor||!c.navigatorInternal.vendor.match(/apple/i))};
return c}(),Ab=function(){return function(c,f,g,e){var b=this;this.viewMetricsHistoryMap={isViewedLogged:!1,isAdUnitViewedLogged:!1,isProgressFiveSecondsLogged:!1,isFirstQuartileLogged:!1,isMidpointLogged:!1,isThirdQuartileLogged:!1,isCompleteLogged:!1,isUnmuteLogged:!1};this.onVideoTimeUpdated=function(a,d,h,n){var k=b.adUnitManager?h:a,q=0;b.adUnitManager&&(q=b.adUnitManager.calculateVideoDurationTotalMsRelativeToAdUnit(h));!b.viewMetricsHistoryMap.isAdUnitViewedLogged&&2E3<=q&&(b.viewMetricsHistoryMap.isAdUnitViewedLogged=
!0,h=b.adUnitManager.getAdUnitPercentInView(),b.metricsManager.reportViewMetricsAdUnitViewed(b.videoAdAttributes,q,h));!b.viewMetricsHistoryMap.isViewedLogged&&2E3<=k&&(b.viewMetricsHistoryMap.isViewedLogged=!0,b.metricsManager.reportViewMetricsVideoViewed(b.videoAdAttributes,k,n));!b.viewMetricsHistoryMap.isProgressFiveSecondsLogged&&5E3<=a&&(b.viewMetricsHistoryMap.isProgressFiveSecondsLogged=!0,b.metricsManager.reportViewMetricsVideoProgressFiveSeconds(b.videoAdAttributes));!b.viewMetricsHistoryMap.isFirstQuartileLogged&&
a>=.25*d&&(b.viewMetricsHistoryMap.isFirstQuartileLogged=!0,b.metricsManager.reportViewMetricsVideoFirstQuartile(b.videoAdAttributes));!b.viewMetricsHistoryMap.isMidpointLogged&&a>=.5*d&&(b.viewMetricsHistoryMap.isMidpointLogged=!0,b.metricsManager.reportViewMetricsVideoMidpoint(b.videoAdAttributes));!b.viewMetricsHistoryMap.isThirdQuartileLogged&&a>=.75*d&&(b.viewMetricsHistoryMap.isThirdQuartileLogged=!0,b.metricsManager.reportViewMetricsVideoThirdQuartile(b.videoAdAttributes))};this.onVideoReadyForPlayback=
function(a,d,h,n){b.metricsManager.reportVideoReadyForPlayback(a,d,h,b.videoAdAttributes,n)};this.onTimeToFirstFrame=function(a,d,h){b.metricsManager.reportTimeToFirstFrame(a,d,h,b.videoAdAttributes)};this.onVideoPlaybackFailure=function(a,d,h){b.metricsManager.reportVideoPlaybackFailure(a,h,d,b.videoAdAttributes)};this.onVideoPlaying=function(a,d,h){b.metricsManager.reportVideoPlaybackStarted(a,d,h,b.videoAdAttributes)};this.onVideoPlaybackPaused=function(a,d,h){b.metricsManager.reportVideoPaused(a,
d,h,b.videoAdAttributes)};this.onPlaybackCompleted=function(a,d){b.viewMetricsHistoryMap.isCompleteLogged||(b.viewMetricsHistoryMap.isCompleteLogged=!0,b.metricsManager.reportViewMetricsVideoComplete(b.videoAdAttributes));b.metricsManager.reportPlaybackCompleted(a,d,b.videoAdAttributes);if(b.eventHandlerOptions&&b.eventHandlerOptions.onPlaybackCompletedCallback)b.eventHandlerOptions.onPlaybackCompletedCallback()};this.onVideoBufferingStarted=function(a,d,h){b.bufferStartTimeMs=a;b.metricsManager.reportVideoBufferingStarted(a,
d,h,b.videoAdAttributes)};this.onVideoBufferingEnded=function(a,d,h){b.bufferStartTimeMs=0;b.metricsManager.reportVideoBufferingEnded(a,d,h,b.videoAdAttributes)};this.onVideoPlaybackFailedAfterPlayError=function(){b.metricsManager.reportPlaybackFailedToStartAfterPlay(b.videoAdAttributes)};this.onVideoAborted=function(a){b.metricsManager.reportVideoAborted(a,b.videoAdAttributes)};this.onVideoSuspended=function(a){b.metricsManager.reportVideoSuspended(a,b.videoAdAttributes)};this.onVideoPlayPromiseRejected=
function(a){b.metricsManager.reportVideoPlayPromiseRejected(a,b.videoAdAttributes)};this.onVideoPlayPromiseNotSupported=function(){b.metricsManager.reportVideoPlayPromiseNotSupported(b.videoAdAttributes)};this.onVideoMuted=function(a,d){b.metricsManager.reportVideoSoundOff(a,d,b.videoAdAttributes)};this.onVideoUnmuted=function(a,d){b.viewMetricsHistoryMap.isUnmuteLogged||(b.viewMetricsHistoryMap.isUnmuteLogged=!0,b.metricsManager.reportViewMetricsVideoUnmute(b.videoAdAttributes));b.metricsManager.reportVideoSoundOn(a,
d,b.videoAdAttributes)};this.onCcOn=function(a,d,h){b.metricsManager.reportCaptionsOn(a,b.videoAdAttributes,d,h)};this.onCcOff=function(a,d,h){b.metricsManager.reportCaptionsOff(a,b.videoAdAttributes,d,h)};this.onCcLoadFailure=function(){b.metricsManager.reportCaptionsLoadFailure(b.videoAdAttributes)};this.onVideoDurationPlayed=function(a,d,h){b.metricsManager.reportVideoDurationPlayed(a,d,h,b.videoAdAttributes)};this.onVideoClicked=function(a){var d;b.metricsManager.reportVideoClicked(a,b.videoAdAttributes);
if(null===(d=b.eventHandlerOptions)||void 0===d?0:d.onImmersiveVideoCallback)b.eventHandlerOptions.onImmersiveVideoCallback(b.videoAdAttributes)};this.onVideoOnScreen=function(a){b.metricsManager.reportVideoOnScreen(a,b.videoAdAttributes)};this.onVideoOffScreen=function(a,d){b.metricsManager.reportVideoOffScreen(a,0!==b.bufferStartTimeMs,d,b.videoAdAttributes)};this.onVideoPlaybackInitiated=function(a){b.metricsManager.reportVideoPlaybackInitiated(a,b.videoAdAttributes)};this.onVideoPlayFromPause=
function(a){b.metricsManager.reportVideoPlayFromPause(a,b.videoAdAttributes)};this.onVideoPauseInitiated=function(a){b.metricsManager.reportVideoPauseInitiated(a,b.videoAdAttributes)};this.onProgressBarReset=function(){b.metricsManager.reportProgressBarReset(b.videoAdAttributes)};this.onVideoPreviewImageNotMediaAmazon=function(){b.metricsManager.reportVideoPreviewImageNotMediaAmazon(b.videoAdAttributes)};this.onVideoPauseButtonTriggered=function(a){b.metricsManager.reportVideoPauseButtonTriggered(a,
b.videoAdAttributes)};this.onVideoViewed=function(a){b.metricsManager.reportVideoView(a,J.isIOSWebView(),b.videoAdAttributes)};this.onVideoClearedOnHiddenBrowser=function(){b.metricsManager.reportVideoClearedOnHiddenBrowser(b.videoAdAttributes)};this.onVideoLoadedOnVisibleBrowser=function(){b.metricsManager.reportVideoLoadedOnVisibleBrowser(b.videoAdAttributes)};this.onAudioToggleIconDisplayed=function(){b.metricsManager.reportAudioToggleIconDisplayed(b.videoAdAttributes)};this.onPauseIconDisplayed=
function(){b.metricsManager.reportPauseIconDisplayed(b.videoAdAttributes)};this.onVideoPausedDueToAutoplayDisabled=function(){b.metricsManager.reportVideoPausedOnAutoplayDisabled(b.videoAdAttributes)};this.onProgressBarDisplayed=function(){b.metricsManager.reportProgressBarDisplayed(b.videoAdAttributes)};this.metricsManager=c;this.videoAdAttributes=f;this.bufferStartTimeMs=0;this.eventHandlerOptions=g;this.adUnitManager=e}}(),Ca=function(){return function(c,f){var g=this;this.reportIfBoundaryCrossed=
function(e,b,a,d,h){g.isValidBoundaryTime(a)&&(e<=b?g.insideInterval(e,b)&&g.callback(g.boundaryTime,d,h):(g.insideInterval(0,b)||g.insideInterval(e,a))&&g.callback(g.boundaryTime,d,h))};this.insideInterval=function(e,b){return g.boundaryTime>e&&g.boundaryTime<=b};this.isValidBoundaryTime=function(e){return 0<=g.boundaryTime&&g.boundaryTime<=e};this.boundaryTime=c;this.callback=f}}(),ja=function(){function c(){}c.getPercentInView=function(f,g){var e=B().defaultView;try{var b=e.innerWidth||e.clientWidth||
0,a=e.innerHeight||e.clientHeight||0,d=c.getNormalizedBoundingRect(f),h=c.getViewableSegment(d.top,d.bottom,a),n=c.getViewableSegment(d.left,d.right,b);f=void 0;f=(null===g||void 0===g?0:g.shouldAreaOnlyUseElementWidth)?d.width:Math.min(d.width,b);return h*n/(d.height*f)}catch(k){return 0}};c.getViewableSegment=function(f,g,e){return f>e&&g>e?0:Math.min(0<f?e-f:0<g?Math.min(g,e):0,g-f)};c.getNormalizedBoundingRect=function(f){f=f.getBoundingClientRect();f.height=f.height||f.bottom-f.top;f.width=f.width||
f.right-f.left;return f};return c}(),z;(function(c){c.PLAYING="playing";c.PAUSED="paused";c.BUFFERING="buffering";c.INITIATED="initiated";c.END="ended"})(z||(z={}));var Bb=function(){return function(c,f,g,e,b){var a=this;void 0===g&&(g=[]);void 0===e&&(e=[]);void 0===b&&(b=A["default"].cardRoot);this.play=function(d){a.initiatedPlayTime||(a.initiatedPlayTime=d);return a.playbackState!==z.PLAYING&&a.videoElement.paused?(d=a.playInternal())?d:Promise.reject("NotSupported"):Promise.resolve()};this.pause=
function(){a.playbackState!==z.PAUSED&&a.playbackState===z.PLAYING&&(a.playbackState=z.PAUSED,a.videoElement.pause())};this.seekToStart=function(){a.accrueContinuousPlaybackDuration(a.getCurrentTimeMs());a.lastOnTimeUpdateCurrentTimeMs=0;a.videoElement.currentTime=0};this.mute=function(){a.videoElement.muted=!0};this.unmute=function(){a.videoElement.muted=!1};this.isMuted=function(){return a.videoElement.muted};this.toggleCaptions=function(d){a.videoElement.textTracks[0].mode=d?"showing":"hidden"};
this.getCaptionLang=function(){return null!=a.videoElement.textTracks[0].language?a.videoElement.textTracks[0].language:"No Language Given"};this.getCurrentTimeMs=function(){return Math.round(1E3*a.videoElement.currentTime)};this.getDurationMs=function(){return Math.round(1E3*a.videoElement.duration)};this.getDroppedFrames=function(){return a.videoElement.getVideoPlaybackQuality?a.videoElement.getVideoPlaybackQuality().droppedVideoFrames:void 0!==a.videoElement.webkitDroppedFrameCount?a.videoElement.webkitDroppedFrameCount:
-1};this.getContinuousPlaybackDurationMs=function(){return a.continuousDurationAccruedPlayTimeMs+(a.getCurrentTimeMs()-a.continuousDurationStartTimeMs)};this.resetContinuousPlaybackDurationMs=function(){var d=a.getCurrentTimeMs();a.continuousDurationAccruedPlayTimeMs=0;d===a.getDurationMs()?a.continuousDurationStartTimeMs=0:a.continuousDurationStartTimeMs=d;a.continuousDurationBoundaryChecks.forEach(function(h){h.resetReported()})};this.getPercentDownloaded=function(){var d=a.videoElement.buffered;
if(!d)return 0;for(var h=0,n=0;n<d.length;n++)h+=d.end(n)-d.start(n);return h/a.videoElement.duration};this.load=function(){a.videoElement.load()};this.loadVideoOnBrowserVisible=function(){var d=a.videoElement.dataset.videoSource;!a.videoElement.src&&d&&(a.videoElement.src=d,a.load(),a.eventHandler.onVideoLoadedOnVisibleBrowser())};this.clear=function(){a.videoElement.dataset.videoSource=a.videoElement.src;a.videoElement.removeAttribute("src");a.load();a.eventHandler.onVideoClearedOnHiddenBrowser()};
this.getDateTime=function(){return Date.now()};this.playInternal=function(){return a.videoElement.play()};this.videoOnCanPlayEvent=function(){a.stopVideoLoadingAnimation();if(!a.assetLoaded){var d=a.getDateTime()-a.loadStartTime;a.eventHandler.onVideoReadyForPlayback(d,a.retryLoadCount,a.getPercentDownloaded(),a.getDurationMs());a.assetLoaded=!0}};this.stopVideoLoadingAnimation=function(){if(a.isVideoLoadingAnimationVisible){var d=a.videoContainer.querySelector("[data-type=loadingAnimation]");d&&
(d.style.visibility="hidden",a.isVideoLoadingAnimationVisible=!1)}};this.videoOnErrorEvent=function(){!a.assetLoaded&&3>a.retryLoadCount?(a.retryLoadCount++,setTimeout(a.videoElement.load.bind(a.videoElement),2E3)):(a.stopVideoLoadingAnimation(),a.handleVideoPlaybackFailureEvent())};this.videoOnPlayingEvent=function(){a.handleFirstFramePlayedEvent();if(a.playbackState===z.BUFFERING)a.eventHandler.onVideoBufferingEnded(a.getCurrentTimeMs(),a.getPercentDownloaded(),a.getDroppedFrames());if(a.playbackState!==
z.END)a.eventHandler.onVideoPlaying(a.getCurrentTimeMs(),a.getPercentDownloaded(),a.getDroppedFrames());a.playbackState=z.PLAYING};this.videoOnPauseEvent=function(){a.videoElement.currentTime!==a.videoElement.duration&&(a.playbackState=z.PAUSED,a.eventHandler.onVideoPlaybackPaused(a.getCurrentTimeMs(),a.getPercentDownloaded(),a.getDroppedFrames()))};this.videoOnEndedEvent=function(){return p.__awaiter(a,void 0,void 0,function(){return p.__generator(this,function(d){switch(d.label){case 0:return this.playbackState=
z.END,this.accrueContinuousPlaybackDuration(this.getDurationMs()),this.eventHandler.onPlaybackCompleted(this.getDurationMs(),this.getDroppedFrames()),this.videoElement.dataset.disableLooping&&"false"!==this.videoElement.dataset.disableLooping?[3,2]:[4,this.playInternal()];case 1:d.sent(),d.label=2;case 2:return[2]}})})};this.videoOnWaitingEvent=function(){a.playbackState=z.BUFFERING;a.eventHandler.onVideoBufferingStarted(a.getCurrentTimeMs(),a.getPercentDownloaded(),a.getDroppedFrames())};this.videoOnTimeUpdateEvent=
function(){var d=a.getCurrentTimeMs(),h=a.getContinuousPlaybackDurationMs();a.continuousDurationBoundaryChecks.forEach(function(k){k.reportIfBoundaryCrossed(h)});a.boundaryChecks.forEach(function(k){k.reportIfBoundaryCrossed(a.lastOnTimeUpdateCurrentTimeMs,d,a.getDurationMs(),a.getPercentDownloaded(),a.getDroppedFrames())});a.lastOnTimeUpdateCurrentTimeMs=d;var n=ja.getPercentInView(a.videoElement);a.eventHandler.onVideoTimeUpdated(d,a.getDurationMs(),h,n)};this.videoOnAbortEvent=function(){a.stopVideoLoadingAnimation();
a.eventHandler.onVideoAborted(a.getCurrentTimeMs())};this.videoOnSuspendEvent=function(){a.eventHandler.onVideoSuspended(a.getCurrentTimeMs())};this.handleFirstFramePlayedEvent=function(){if(!a.firstFramePlayed){var d=a.getDateTime()-a.initiatedPlayTime;a.eventHandler.onTimeToFirstFrame(d,a.getPercentDownloaded(),a.getDroppedFrames());a.firstFramePlayed=!0}};this.handleVideoPlaybackFailureEvent=function(){if(a.videoElement.error){var d=a.translateVideoErrorCode(a.videoElement.error.code);a.eventHandler.onVideoPlaybackFailure(a.getCurrentTimeMs(),
d,a.videoElement.error.message)}};this.translateVideoErrorCode=function(d){switch(d){case 1:return"MEDIA_ERR_ABORTED";case 2:return"MEDIA_ERR_NETWORK";case 3:return"MEDIA_ERR_DECODE";case 4:return"MEDIA_ERR_SRC_NOT_SUPPORTED";default:return"UNKNOWN"}};this.accrueContinuousPlaybackDuration=function(d){a.continuousDurationAccruedPlayTimeMs+=d-a.continuousDurationStartTimeMs;a.continuousDurationStartTimeMs=0};this.videoElement=c;this.eventHandler=f;this.lastOnTimeUpdateCurrentTimeMs=this.continuousDurationAccruedPlayTimeMs=
this.continuousDurationStartTimeMs=0;this.boundaryChecks=g;this.continuousDurationBoundaryChecks=e;this.playbackState=z.INITIATED;this.loadStartTime=this.getDateTime();this.assetLoaded=!1;this.retryLoadCount=0;this.firstFramePlayed=!1;this.isVideoLoadingAnimationVisible=!0;this.videoContainer=b;this.videoElement.oncanplay=this.videoOnCanPlayEvent;this.videoElement.onerror=this.videoOnErrorEvent;this.videoElement.onplaying=this.videoOnPlayingEvent;this.videoElement.onpause=this.videoOnPauseEvent;this.videoElement.onended=
this.videoOnEndedEvent;this.videoElement.onwaiting=this.videoOnWaitingEvent;this.videoElement.ontimeupdate=this.videoOnTimeUpdateEvent;this.videoElement.onabort=this.videoOnAbortEvent;this.videoElement.onsuspend=this.videoOnSuspendEvent;4===this.videoElement.readyState&&(this.eventHandler.onVideoReadyForPlayback(0,0,this.getPercentDownloaded(),this.getDurationMs()),this.assetLoaded=!0,this.stopVideoLoadingAnimation());if(this.videoElement.error&&this.videoElement.error.code)this.videoElement.onerror("TriggeredBeforeInit");
c=this.videoElement.dataset.poster;this.videoElement.poster!==c&&(this.videoElement.poster=c)}}(),ka=function(){function c(){}c.registeredElements=[];c.attachedToViewWillDisappear=!1;c.registerElement=function(f,g,e,b,a,d,h,n){f={callback:d,dispatchOnElementInView:e,dispatchOnElementOutOfView:b,element:f,isInView:void 0,ratioInView:g,recurring:a,eventData:h,options:n};0===c.registeredElements.length&&c.attachListeners();c.registeredElements.push(f);c.handleViewChange(f)};c.deregisterElement=function(f,
g,e,b,a){c.registeredElements=c.registeredElements.filter(function(d){return!(d.element===f&&d.ratioInView===g&&d.dispatchOnElementInView===e&&d.dispatchOnElementOutOfView===b&&d.recurring===a)});0===c.registeredElements.length&&c.detachListeners()};c.emitViewabilityChange=function(f,g){f.isInView=g;f.callback(f.ratioInView,g,f.eventData);f.recurring||c.deregisterElement(f.element,f.ratioInView,f.dispatchOnElementInView,f.dispatchOnElementOutOfView,f.recurring)};c.handleRatioInViewChange=function(f,
g){f.dispatchOnElementInView&&g>=f.ratioInView&&!f.isInView&&c.emitViewabilityChange(f,!0);f.dispatchOnElementOutOfView&&g<f.ratioInView&&f.isInView&&c.emitViewabilityChange(f,!1)};c.handleBrowserHidden=function(f){c.handleRatioInViewChange(f,0)};c.handleViewChange=function(f){c.handleRatioInViewChange(f,ja.getPercentInView(f.element,f.options))};c.onBrowserHidden=function(){c.registeredElements.forEach(c.handleBrowserHidden)};c.onBrowserShown=function(){c.registeredElements.forEach(c.handleViewChange)};
c.onBrowserVisibilityChange=function(){var f=B().hidden;if(f)c.onBrowserHidden();else setTimeout(c.onBrowserShown,50);c.registeredElements.forEach(function(g){var e,b;null===(b=null===(e=g.options)||void 0===e?void 0:e.onBrowserVisibilityChange)||void 0===b?void 0:b.call(e,!f)})};c.toggleBrowserVisibility=function(){c.onBrowserHidden();c.onBrowserShown()};c.attachListeners=function(){c.throttledOnBrowserViewChange||(c.throttledOnBrowserViewChange=t["default"].throttle(function(){c.registeredElements.forEach(c.handleViewChange)},
50));t["default"].on("afterReady",c.throttledOnBrowserViewChange);t["default"].on(t["default"].constants.BROWSER_EVENTS.SCROLL,c.throttledOnBrowserViewChange);t["default"].on(t["default"].constants.BROWSER_EVENTS.RESIZE,c.throttledOnBrowserViewChange);t["default"].on(t["default"].constants.BROWSER_EVENTS.ORIENTATION_CHANGE,c.throttledOnBrowserViewChange);var f=B().defaultView;w.addEventListener(f,"beforeunload",1,c.onBrowserHidden);w.addEventListener(B(),"visibilitychange",1,c.onBrowserVisibilityChange);
J.isWebView()||(w.addEventListener(f,"focus",1,c.onBrowserShown),w.addEventListener(f,"blur",1,c.onBrowserHidden));J.isSafari()&&!J.isWebView()&&(w.addEventListener(f,"pagehide",1,c.onBrowserHidden),w.addEventListener(f,"pageshow",1,c.onBrowserShown),w.addEventListener(f,"popstate",1,c.toggleBrowserVisibility));c.attachToViewWillDisappear()};c.detachListeners=function(){t["default"].off("afterReady",c.throttledOnBrowserViewChange);t["default"].off(t["default"].constants.BROWSER_EVENTS.SCROLL,c.throttledOnBrowserViewChange);
t["default"].off(t["default"].constants.BROWSER_EVENTS.RESIZE,c.throttledOnBrowserViewChange);t["default"].off(t["default"].constants.BROWSER_EVENTS.ORIENTATION_CHANGE,c.throttledOnBrowserViewChange);var f=B().defaultView;w.removeEventListener(B(),"visibilitychange",1,c.onBrowserVisibilityChange);w.removeEventListener(f,"beforeunload",1,c.onBrowserHidden);J.isWebView()||(w.removeEventListener(f,"focus",1,c.onBrowserShown),w.removeEventListener(f,"blur",1,c.onBrowserHidden));J.isSafari()&&!J.isWebView()&&
(w.removeEventListener(f,"pagehide",1,c.onBrowserHidden),w.removeEventListener(f,"pageshow",1,c.onBrowserShown),w.removeEventListener(f,"popstate",1,c.toggleBrowserVisibility))};c.attachToViewWillDisappear=function(){if(!c.attachedToViewWillDisappear){var f=B().defaultView;c.attachedToViewWillDisappear=!0;f.app||(f.app={});c.previousViewWillDisappear=f.app.willDisappear;f.app.willDisappear=function(){c.onBrowserHidden();c.previousViewWillDisappear&&c.previousViewWillDisappear()}}};return c}(),E;(function(c){c.WAITING=
"waiting";c.TIME_UPDATE="timeupdate";c.PAUSE="pause"})(E||(E={}));var la;(function(c){c.PORTRAIT="PORTRAIT";c.LANDSCAPE="LANDSCAPE";c.SQUARE="SQUARE"})(la||(la={}));var Cb=function(){return function(c,f,g,e,b,a){var d=this;void 0===e&&(e=!1);void 0===b&&(b=!1);void 0===a&&(a={});this.getVideoCurrentTimeMs=function(){return d.videoPlayer.getCurrentTimeMs()};this.getTotalVideoDuration=function(){return d.videoPlayer.getDurationMs()};this.loadVideo=function(){d.videoPlayer.load()};this.setMuteStatus=
function(k,q){d.isMuted=k;d.setMuteButtonStatus(k);d.muteClickRegion&&(k?(d.videoPlayer.mute(),d.videoEventHandler.onVideoMuted(d.getVideoCurrentTimeMs(),q)):(d.videoPlayer.unmute(),d.videoEventHandler.onVideoUnmuted(d.getVideoCurrentTimeMs(),q)))};this.displayProgressBar=function(k){if(d.progressBarContainer&&(d.progressBarContainer.style.visibility=k?"inherit":"hidden",k))d.videoEventHandler.onProgressBarDisplayed()};this.play=function(){if(d.isPlaying())return Promise.resolve();d.videoPlayer.resetContinuousPlaybackDurationMs();
d.videoEventHandler.onVideoPlaybackInitiated(d.getVideoCurrentTimeMs());d.showPlayButton(!1);d.showPauseButton(!0);d.displayProgressBar(!0);d.muteClickRegion&&(d.muteClickRegion.style.display="block",d.videoEventHandler.onAudioToggleIconDisplayed(),d.muteClickRegion.style.visibility="visible");if(d.ccTrack){d.ccTrack.onerror=d.ccLoadFailure;d.ccShowing=!1;if(d.ccTrackFail)d.ccLoadFailure();else if(d.ccClickRegion)d.ccClickRegion.style.display="block",d.ccClickRegion.style.visibility="visible",d.videoEventHandler.onCcOn(P.DEFAULT_ON,
d.videoPlayer.getCaptionLang(),!1);else d.videoEventHandler.onCcOn(P.DEFAULT_ON,d.videoPlayer.getCaptionLang(),!0);d.toggleCC()}return d.videoPlayer.play(Date.now()).then().catch(function(k){var q="string"===typeof k?k:"";k instanceof DOMException&&(q=k.name+": "+k.message);d.showPlayButton(!0);d.muteClickRegion&&(d.muteClickRegion.style.visibility="hidden");d.ccClickRegion&&(d.ccClickRegion.style.visibility="hidden");if(q.startsWith("NotSupported"))d.videoEventHandler.onVideoPlayPromiseNotSupported();
d.videoEventHandler.onVideoPlayPromiseRejected(q)})};this.pause=function(k){d.isPaused()||(d.videoEventHandler.onVideoPauseInitiated(d.getVideoCurrentTimeMs()),d.videoEventHandler.onVideoViewed(d.videoPlayer.getContinuousPlaybackDurationMs()),d.videoPlayer.resetContinuousPlaybackDurationMs(),d.showPauseButton(!1),d.videoOptions.shouldEnablePauseButton?d.displayProgressBar(!0):d.displayProgressBar(!1),!k&&d.videoOptions.shouldEnablePlayButton&&d.showPlayButton(!0),d.muteClickRegion&&(d.muteClickRegion.style.visibility=
"hidden"),d.ccTrack&&(d.ccClickRegion&&(d.ccClickRegion.style.visibility="hidden"),d.toggleCC()),d.videoPlayer.pause())};this.onBrowserVisibilityChange=function(k){d.videoOptions.shouldEnableVideoCleanup&&(k?d.videoPlayer.loadVideoOnBrowserVisible():d.videoPlayer.clear())};this.onOnePercentViewabilityChange=function(k,q){k=Date.now();q?(d.onScreenStartTime=k,d.videoEventHandler.onVideoOnScreen(d.videoPlayer.getPercentDownloaded())):(d.videoPlayer.isMuted()||d.setMuteStatus(!0,U.VIDEO_OFF_SCREEN),
d.videoEventHandler.onVideoOffScreen(k-d.onScreenStartTime,d.getVideoCurrentTimeMs()),d.onScreenStartTime=0,d.videoPlayer.seekToStart(),d.videoPlayer.resetContinuousPlaybackDurationMs())};this.onFiftyPercentViewabilityChange=function(k,q,r){d.isReducedMotionEnabled&&!d.playButtonClicked||d.pauseButtonClicked||(q?d.play().catch():d.pause(r))};this.setVideoOptions=function(k){d.videoOptions=k};this.handleVideoOrientation=function(){var k=d.videoAdAttributes,q=k.videoPreviewImageSrc;if(k=k.videoOrientation===
la.PORTRAIT)void 0===q&&(q=""),k=!q.startsWith("https://m.media-amazon.com");if(k)d.videoEventHandler.onVideoPreviewImageNotMediaAmazon()};this.isPlaying=function(){return d.videoPlayer.playbackState===z.PLAYING};this.isPaused=function(){return d.videoPlayer.playbackState===z.PAUSED};this.buildBoundaryListeners=function(){return[new Ca(2E3,d.videoEventHandler.onVideoDurationPlayed),new Ca(15E3,d.videoEventHandler.onVideoDurationPlayed)]};this.toggleAudio=function(){d.setMuteStatus(!d.videoPlayer.isMuted(),
U.ICON_TAP)};this.toggleCC=function(){d.ccShowing=!d.ccShowing;d.videoPlayer.toggleCaptions(d.ccShowing);d.ccButtonOff&&d.ccButtonOn&&(d.ccShowing?(d.videoEventHandler.onCcOn(P.ICON_TAP,d.videoPlayer.getCaptionLang(),!1),d.ccButtonOn.style.opacity="1",d.ccButtonOff.style.opacity="0"):(d.videoEventHandler.onCcOff(P.ICON_TAP,d.videoPlayer.getCaptionLang(),!1),d.ccButtonOn.style.opacity="0",d.ccButtonOff.style.opacity="1"))};this.showPlayButton=function(k){d.playClickRegion&&(d.playClickRegion.style.visibility=
k?"inherit":"hidden")};this.showPauseButton=function(k){if(d.pauseClickRegion&&(d.pauseClickRegion.style.visibility=k?"inherit":"hidden",k))d.videoEventHandler.onPauseIconDisplayed()};this.setUpPlayButtonEvents=function(){d.playClickRegion&&d.playClickRegion.addEventListener("click",function(){d.play();d.playButtonClicked=!0;if(d.playButtonClicked&&d.pauseButtonClicked)d.videoEventHandler.onVideoPlayFromPause(d.getVideoCurrentTimeMs());d.pauseButtonClicked=!1})};this.setUpPauseButtonEvents=function(){d.pauseClickRegion&&
d.pauseClickRegion.addEventListener("click",function(){d.pause();d.pauseButtonClicked=!0;d.videoEventHandler.onVideoPauseButtonTriggered(d.getVideoCurrentTimeMs());d.playButtonClicked=!1})};this.ccLoadFailure=function(){d.ccTrackFail=!0;d.videoEventHandler.onCcLoadFailure();d.ccClickRegion&&(d.ccClickRegion.style.visibility="hidden")};this.setMuteButtonStatus=function(k){d.muteButton&&d.unmuteButton&&(k?(d.unmuteButton.style.fillOpacity="0",d.muteButton.style.fillOpacity="1"):(d.muteButton.style.fillOpacity=
"0",d.unmuteButton.style.fillOpacity="1"))};this.logClick=function(){d.videoEventHandler.onVideoClicked(d.getVideoCurrentTimeMs())};this.updateProgressBar=function(k){if(d.progressBar)if(k===E.WAITING||k===E.PAUSE)d.progressBar.style.transition="none";else{k=d.getVideoCurrentTimeMs();var q=d.getTotalVideoDuration(),r=Math.floor(k/q*100);if(0===r)d.videoEventHandler.onProgressBarReset();else r=Math.floor((k+500)/q*100);k=100<r?100:r;d.progressBar.style.transition=0===k?"none":"width 0.5s linear";d.progressBar.style.width=
k+"%"}};this.element=c;this.videoAdAttributes=g;this.videoEventHandler=f;g=this.videoOptions=a;c=g.shouldEnablePlayButton;f=g.shouldEnablePauseButton;a=g.shouldEnableReduceMotionEffects;g=this.element.querySelector("video");var h=this.buildBoundaryListeners(),n="true"===(null===g||void 0===g?void 0:g.getAttribute("data-videoloadedusinginlinescript"))?!0:!1;this.videoPlayer=new Bb(g,this.videoEventHandler,h,[],this.element);b||n||this.videoPlayer.load();this.element.querySelectorAll("a").forEach(function(k){k.addEventListener("click",
d.logClick)});if(this.muteClickRegion=this.element.querySelector('[data-type="audioToggleContainer"]'))this.muteButton=this.muteClickRegion.querySelector('[data-type="audioToggleMute"]'),this.unmuteButton=this.muteClickRegion.querySelector('[data-type="audioToggleUnmute"]'),this.setMuteButtonStatus(this.videoPlayer.isMuted()),this.muteClickRegion.addEventListener("click",this.toggleAudio),this.isMuted=this.videoPlayer.isMuted();this.ccTrackFail=!1;if(this.ccTrack=this.element.querySelector('[data-type="ccTrack"]'))this.ccTrack.onerror=
this.ccLoadFailure;if(this.ccClickRegion=this.element.querySelector('[data-type="ccToggleContainer"]'))this.ccClickRegion.style.visibility="hidden",this.ccButtonOff=this.ccClickRegion.querySelector('[data-type="ccToggleOff"]'),this.ccButtonOn=this.ccClickRegion.querySelector('[data-type="ccToggleOn"]'),this.ccClickRegion.addEventListener("click",this.toggleCC);this.playClickRegion=this.element.querySelector('[data-type="playIcon"]');f&&(this.videoOptions.shouldEnablePlayButton=!0,this.setUpPlayButtonEvents(),
this.pauseClickRegion=this.element.querySelector('[data-type="pauseIcon"]'),this.setUpPauseButtonEvents());a&&(b=mb("(prefers-reduced-motion: reduce)"),this.isReducedMotionEnabled=!(null===b||void 0===b||!b.matches));this.isReducedMotionEnabled&&(c=!0,this.setUpPlayButtonEvents(),this.videoEventHandler.onVideoPausedDueToAutoplayDisabled());this.showPlayButton(c);this.progressBar=this.element.querySelector('[data-type="progressBar"]');this.progressBarContainer=this.element.querySelector('[data-type="progressBarContainer"]');
this.progressBar&&g&&(g.addEventListener(E.TIME_UPDATE,function(){return d.updateProgressBar(E.TIME_UPDATE)}),g.addEventListener(E.WAITING,function(){return d.updateProgressBar(E.WAITING)}),f&&g.addEventListener(E.PAUSE,function(){return d.updateProgressBar(E.PAUSE)}));this.handleVideoOrientation();e||(ka.registerElement(g,.5,!0,!0,!0,this.onFiftyPercentViewabilityChange),ka.registerElement(g,.01,!0,!0,!0,this.onOnePercentViewabilityChange,void 0,{onBrowserVisibilityChange:this.onBrowserVisibilityChange}))}}(),
Da=function(){function c(){}c.addItem=function(f,g){var e=c.getState();e[f]=g;c.updatePageState(e)};c.getItem=function(f){return c.getState()[f]};c.getState=function(){return t["default"].state("sb-video-state")||{}};c.removeItem=function(f){var g=c.getState();delete g[f];c.updatePageState(g)};c.updatePageState=function(f){t["default"].state("sb-video-state",f)};return c}(),Db=function(){return function(c,f){var g,e=this;this.getTreatment=function(k){if(0===e.weblabsMap.size)va["default"].log("There are no weblabs information found by ClientWebLapHlper",
"ERROR",e.attribution);else{if(e.weblabsMap.has(k))return e.weblabsMap.get(k);va["default"].log("Get treatment for unknown weblab","ERROR",e.attribution)}};var b=new Map;c=c.split(",").filter(function(k){return 0<k.length});if(0<c.length)try{for(var a=p.__values(c),d=a.next();!d.done;d=a.next()){var h=d.value.split(":");b.set(h[0].trim(),h[1].trim())}}catch(k){var n={error:k}}finally{try{d&&!d.done&&(g=a.return)&&g.call(a)}finally{if(n)throw n.error;}}this.weblabsMap=b;this.attribution=f}}(),W;(function(c){c.DESKTOP=
"Desktop";c.MOBILE="Mobile"})(W||(W={}));var F;(function(c){c.VIDEO_SINGLE_PRODUCT="video-single-product";c.MULTI_BRAND_VIDEO="multi-brand-video";c.VIDEO_SINGLE_BRAND="video-single-brand";c.VIDEO_STORE="video-store";c.VIDEO_STORE_PRODUCT_FEATURE="video-store-product-feature";c.VIDEO_PRODUCT_COLLECTION="video-product-collection";c.SHORT_FORM_VIDEO="short-form-video";c.THEMATIC_VIDEO="thematic-video";c.VIDEO_SPLIT="video-split"})(F||(F={}));var X;(function(c){c.SPARKLE_MOBILE="loom-mobile-top-slot";
c.SPARKLE_DESKTOP="loom-desktop-top-slot";c.INLINE_MOBILE="loom-mobile-inline-slot";c.INLINE_DESKTOP="loom-desktop-inline-slot";c.BOTTOM_MOBILE="loom-mobile-bottom-slot";c.BOTTOM_DESKTOP="loom-desktop-bottom-slot";c.MOBILE_HQP="mobile-hero-quick-promo";c.BRAND_DISCOVERY_FEEDS_MOBILE="brand-discovery-feeds-mobile"})(X||(X={}));var Y,ma,Z,aa,ba,na,ca,da,C={SBV_468340:"SBV_468340",SBV_672322:"SBV_672322",SBV_708584:"SBV_708584",SBV_834356:"SBV_834356",SBV_836067:"SBV_836067",SBV_842986:"SBV_842986",
ADPT_SBV_880477:"ADPT_SBV_880477"},Ea=p.__assign(p.__assign({},C),{SBV_623814:"SBV_623814",SBV_633512:"SBV_633512",SBV_633539:"SBV_633539",SBV_633907:"SBV_633907",SBV_736363:"SBV_736363",SBV_776653:"SBV_776653",SBV_814590:"SBV_814590",ADPT_SBV_948350:"ADPT_SBV_948350",ADPT_SBV_956803:"ADPT_SBV_956803"}),Fa=p.__assign(p.__assign({},Ea),{MBV_394048:"MBV_394048",SBV_414150:"SBV_414150",SBV_427616:"SBV_427616",ADPT_SBV_959560:"ADPT_SBV_959560",SBV_620753:"SBV_620753",SBV_642751:"SBV_642751",SBV_656845:"SBV_656845",
SBV_668132:"SBV_668132",BUYX_DP_PAPERCUT_EXPERIMENTS_PRICE_COLOR_705983:"BUYX_DP_PAPERCUT_EXPERIMENTS_PRICE_COLOR_705983"}),Ga=p.__assign(p.__assign({},Ea),{MBV_394383:"MBV_394383",SBV_414153:"SBV_414153",SBV_427647:"SBV_427647",ADPT_SBV_959572:"ADPT_SBV_959572",ADPT_SBV_983988:"ADPT_SBV_983988",SBV_642769:"SBV_642769",SBV_656827:"SBV_656827",SBV_668135:"SBV_668135",SBV_677302:"SBV_677302",SBV_682273:"SBV_682273",ADPT_SBV_992627:"ADPT_SBV_992627"}),Ha=p.__assign(p.__assign({},C),{SBV_649291:"SBV_649291",
ADPT_SBV_956803:"ADPT_SBV_956803"}),Ia=p.__assign(p.__assign({},C),{SB_DP_THEMATIC_HRB_VIDEO_DESKTOP_598713:"SB_DP_THEMATIC_HRB_VIDEO_DESKTOP_598713"}),Ja=p.__assign(p.__assign({},C),{SB_DP_THEMATIC_HRB_VIDEO_MOBILE_598714:"SB_DP_THEMATIC_HRB_VIDEO_MOBILE_598714"}),Ka=p.__assign(p.__assign({},C),{SBV_576903:"SBV_576903",SBV_576904:"SBV_576904"}),La=p.__assign(p.__assign({},C),{SBV_576917:"SBV_576917",SBV_576918:"SBV_576918"}),Ma=p.__assign(p.__assign({},C),{SBV_476799:"SBV_476799",SBV_485007:"SBV_485007",
SB_VIDEO_CONTENT_DEDUPE_454175:"SB_VIDEO_CONTENT_DEDUPE_454175",SBV_737682:"SBV_737682",ADPT_SBV_881393:"ADPT_SBV_881393"}),Na=p.__assign(p.__assign({},Ma),{SBV_793878:"SBV_793878"}),Oa=p.__assign(p.__assign({},Ma),{ADPT_SBV_SEARCH_912243:"ADPT_SBV_SEARCH_912243"}),oa=p.__assign(p.__assign({},C),{SBV_476799:"SBV_476799",SBV_485007:"SBV_485007",SBV_635550:"SBV_635550",SB_VIDEO_CONTENT_DEDUPE_454175:"SB_VIDEO_CONTENT_DEDUPE_454175",SBV_716513:"SBV_716513",SBV_723533:"SBV_723533",SBV_737682:"SBV_737682",
ADPT_SBV_881393:"ADPT_SBV_881393"}),Eb=p.__assign(p.__assign({},oa),{ADPT_SBV_SEARCH_912243:"ADPT_SBV_SEARCH_912243"}),Pa=p.__assign(p.__assign({},C),{SBV_716513:"SBV_716513",SBV_724265:"SBV_724265",SBV_737682:"SBV_737682",SBV_733716:"SBV_733716",SBV_826059:"SBV_826059",SBV_826060:"SBV_826060",SBV_826061:"SBV_826061",SEARCH_637704:"SEARCH_637704",ADPT_SEARCH_821829:"ADPT_SEARCH_821829",ADPT_SEARCH_809719:"ADPT_SEARCH_809719",ADPT_SEARCH_824668:"ADPT_SEARCH_824668",SEARCH_758318:"SEARCH_758318",SBV_776577:"SBV_776577",
SBV_798693:"SBV_798693",SBV_798694:"SBV_798694",SBV_798703:"SBV_798703",SBV_798704:"SBV_798704",ADPT_SBV_881393:"ADPT_SBV_881393",ADPT_SBV_956803:"ADPT_SBV_956803"}),Qa=p.__assign(p.__assign(p.__assign({},C),Pa),{SEARCH_737855:"SEARCH_737855",SEARCH_791154:"SEARCH_791154",ADPT_SBV_SEARCH_948552:"ADPT_SBV_SEARCH_948552",ADPT_SBV_890511:"ADPT_SBV_890511",ADPT_SBV_990170:"ADPT_SBV_990170"}),Ra=p.__assign(p.__assign(p.__assign({},C),Pa),{SEARCH_737563:"SEARCH_737563",SEARCH_786608:"SEARCH_786608",SEARCH_791155:"SEARCH_791155",
ADPT_SBV_877926:"ADPT_SBV_877926",ADPT_SBV_964336:"ADPT_SBV_964336",ADPT_SBV_SEARCH_867911:"ADPT_SBV_SEARCH_867911",ADPT_SBV_SEARCH_912243:"ADPT_SBV_SEARCH_912243",ADPT_SBV_SEARCH_954307:"ADPT_SBV_SEARCH_954307",ADPT_SBV_SEARCH_953287:"ADPT_SBV_SEARCH_953287",ADPT_SBV_SEARCH_963810:"ADPT_SBV_SEARCH_963810",ADPT_SBV_1001786:"ADPT_SBV_1001786"}),Fb=p.__assign({},C),M=p.__assign(p.__assign(p.__assign(p.__assign(p.__assign(p.__assign(p.__assign(p.__assign(p.__assign(p.__assign(p.__assign(p.__assign({},
Fa),Ga),Ka),La),Na),Oa),oa),Qa),Ra),Ha),Ia),Ja),Q=W.DESKTOP,K=W.MOBILE,Gb=F.MULTI_BRAND_VIDEO,Hb=F.SHORT_FORM_VIDEO,Ib=F.THEMATIC_VIDEO,Jb=F.VIDEO_SINGLE_BRAND,Kb=F.VIDEO_PRODUCT_COLLECTION,Lb=F.VIDEO_SPLIT,Mb=F.VIDEO_STORE,Nb=F.VIDEO_STORE_PRODUCT_FEATURE;var H={};H[Gb]=(Y={},Y[Q]=Fa,Y[K]=Ga,Y);H[Hb]=(ma={},ma[K]=Ha,ma);H[Ib]=(Z={},Z[Q]=Ia,Z[K]=Ja,Z);H[Jb]=(aa={},aa[Q]=Ka,aa[K]=La,aa);H[Kb]=(ba={},ba[Q]=Qa,ba[K]=Ra,ba);H[Lb]=(na={},na[K]=Fb,na);H[Mb]=(ca={},ca[Q]=Na,ca[K]=Oa,ca);H[Nb]=(da={},da[Q]=
oa,da[K]=Eb,da);H;var I;(function(c){c.C="C";c.T1="T1";c.T2="T2";c.T3="T3";c.T4="T4";c.T5="T5";c.T6="T6";c.T7="T7"})(I||(I={}));var Ob=function(){return function(c,f,g){var e=this;this.onBackgroundClicked=function(){e.metricsManager.reportBackgroundClicked(e.videoManager.getVideoCurrentTimeMs(),e.videoManager.videoAdAttributes)};this.onCtaClicked=function(){e.metricsManager.reportBrandCtaLinkClicked(e.videoManager.getVideoCurrentTimeMs(),e.videoManager.videoAdAttributes)};this.onCtaBannerClicked=
function(){e.metricsManager.reportCtaBannerClicked(e.videoManager.getVideoCurrentTimeMs(),e.videoManager.videoAdAttributes)};this.onHeadlineClicked=function(){e.metricsManager.reportHeadlineClicked(e.videoManager.getVideoCurrentTimeMs(),e.videoManager.videoAdAttributes)};this.onBrandCtaLinkClicked=function(){e.metricsManager.reportBrandCtaLinkClicked(e.videoManager.getVideoCurrentTimeMs(),e.videoManager.videoAdAttributes)};this.onBrandLogoClicked=function(){e.metricsManager.reportBrandLogoClicked(e.videoManager.getVideoCurrentTimeMs(),
e.videoManager.videoAdAttributes)};this.onBrandNameClicked=function(){e.metricsManager.reportBrandNameClicked(e.videoManager.getVideoCurrentTimeMs(),e.videoManager.videoAdAttributes)};this.onCreatorLogoClicked=function(){e.metricsManager.reportCreatorLogoClicked(e.videoManager.getVideoCurrentTimeMs(),e.videoManager.videoAdAttributes)};this.onCreatorCtaClicked=function(){e.metricsManager.reportCreatorCtaClicked(e.videoManager.getVideoCurrentTimeMs(),e.videoManager.videoAdAttributes)};this.productReceived=
function(b){var a;void 0===b&&(b=0);var d=(null===(a=e.widgetEventAttributes)||void 0===a?0:a.productAttributes)&&0<e.widgetEventAttributes.productAttributes.length?e.widgetEventAttributes.productAttributes[b]:void 0;e.metricsManager.reportProductReceived(e.videoManager.getVideoCurrentTimeMs(),e.videoManager.videoAdAttributes,d)};this.onProductClicked=function(b){var a;void 0===b&&(b=0);var d=(null===(a=e.widgetEventAttributes)||void 0===a?0:a.productAttributes)&&0<e.widgetEventAttributes.productAttributes.length?
e.widgetEventAttributes.productAttributes[b]:void 0;e.metricsManager.reportProductClicked(e.videoManager.getVideoCurrentTimeMs(),e.videoManager.videoAdAttributes,d)};this.metricsManager=c;this.videoManager=f;this.widgetEventAttributes=g}}(),Pb=function(){function c(f,g){var e=this;this.setupBackgroundEvent=function(){e.widgetElements.backgroundElement&&e.widgetElements.backgroundElement.addEventListener("click",e.widgetEventHandler.onBackgroundClicked)};this.setupBrandLogoEvent=function(){e.widgetElements.brandLogoElement&&
e.widgetElements.brandLogoElement.querySelectorAll("a").forEach(function(b){b.addEventListener("click",e.widgetEventHandler.onBrandLogoClicked)});e.widgetElements.brandElement&&e.widgetElements.brandElement.querySelectorAll("a").forEach(function(b){b.addEventListener("click",e.widgetEventHandler.onBrandCtaLinkClicked)})};this.setupCallToActionEvent=function(){e.widgetElements.callToActionElement&&e.widgetElements.callToActionElement.querySelectorAll("a").forEach(function(b){b.addEventListener("click",
e.widgetEventHandler.onCtaClicked)});e.widgetElements.callToActionBannerElement&&e.widgetElements.callToActionBannerElement.querySelectorAll("a").forEach(function(b){b.addEventListener("click",e.widgetEventHandler.onCtaBannerClicked)})};this.setupHeadlineEvent=function(){e.widgetElements.headlineElement&&e.widgetElements.headlineElement.querySelectorAll("*").forEach(function(b){b.addEventListener("click",e.widgetEventHandler.onHeadlineClicked)})};this.setupProductEvents=function(){e.widgetElements.productElements&&
e.widgetElements.productElements.forEach(function(b,a){b&&(e.widgetEventHandler.productReceived(a),b.querySelectorAll("a").forEach(function(d){d.addEventListener("click",function(){e.widgetEventHandler.onProductClicked(a)})}))})};this.setUpCreatorContentEvents=function(){e.setupBrandNameEvent();e.setupCreatorCtaEvent();e.setupCreatorLogoEvent()};this.setupBrandNameEvent=function(){e.widgetElements.brandNameElement&&e.widgetElements.brandNameElement.querySelectorAll("a").forEach(function(b){b.addEventListener("click",
e.widgetEventHandler.onBrandNameClicked)})};this.setupCreatorCtaEvent=function(){e.widgetElements.creatorNameElement&&e.widgetElements.creatorNameElement.querySelectorAll("a").forEach(function(b){b.addEventListener("click",e.widgetEventHandler.onCreatorCtaClicked)})};this.setupCreatorLogoEvent=function(){e.widgetElements.creatorLogoElement&&e.widgetElements.creatorLogoElement.querySelectorAll("a").forEach(function(b){b.addEventListener("click",e.widgetEventHandler.onCreatorLogoClicked)})};this.widgetElements=
f;this.widgetEventHandler=g}c.prototype.setupWidgetEvents=function(){this.setupBackgroundEvent();this.setupBrandLogoEvent();this.setupCallToActionEvent();this.setupHeadlineEvent();this.setupProductEvents();this.setUpCreatorContentEvents()};return c}(),Sa={shouldAreaOnlyUseElementWidth:!0},Qb=function(){return function(c){var f=this;this.attach=function(){f.setupAdUnitViewability()};this.setupAdUnitViewability=function(){ka.registerElement(f.adUnitElement,.5,!0,!0,!0,f.onFiftyPercentViewabilityChange,
void 0,Sa)};this.onFiftyPercentViewabilityChange=function(g,e){f.adUnitInView=e};this.isAdUnitInView=function(){return f.adUnitInView};this.calculateVideoDurationTotalMsRelativeToAdUnit=function(g){f.isAdUnitInView()?f.videoDurationTotalMsWhenAdInViewFirst=g-f.videoDurationStartTimeMsWhenAdInViewFirst:(f.videoDurationTotalMsWhenAdInViewFirst=0,f.videoDurationStartTimeMsWhenAdInViewFirst=g);return f.videoDurationTotalMsWhenAdInViewFirst};this.getAdUnitPercentInView=function(){return ja.getPercentInView(f.adUnitElement,
Sa)};this.adUnitElement=c;this.adUnitInView=!1;this.videoDurationTotalMsWhenAdInViewFirst=this.videoDurationStartTimeMsWhenAdInViewFirst=0}}(),Rb=function(c){return c===X.SPARKLE_DESKTOP||c===X.SPARKLE_MOBILE},Sb=function(c){return J.isIOSWebView()&&c.getTreatment(M.SBV_834356)===I.T1||c.getTreatment(M.SBV_836067)===I.T1},Vb=function(c){return p.__awaiter(void 0,void 0,void 0,function(){var f,g,e,b,a,d,h,n,k,q,r,u,v,x,N,R,pa,qa,Ta,Ua,Va,ra,Wa,Tb,Xa,Ya;return p.__generator(this,function(dc){if(!A["default"].cardRoot.dataset.properties)return y.count("sbVideoStoresNoProps"),
[2];f=c.brandLogoElementSelector;g=c.isAsinCard;e=c.enableAdFeedback;b=c.hlsVideoSrc;a=JSON.parse(A["default"].cardRoot.dataset.properties);d=new Db(a.weblabs,a.widgetType);h=d.getTreatment(M.SBV_672322)===I.T1;n=d.getTreatment(M.SBV_737682)===I.T1&&Rb(a.widgetGroupId);k={shouldLogViewMetrics:!0,shouldLogAdUnitViewMetrics:n};q=new ub({clientId:a.clientId,deviceEnv:t["default"].capabilities.isAmazonApp?"app":"web",deviceOs:ob(),deviceType:ya(),language:a.language,marketplaceId:a.marketplaceId,pageNumber:a.pageNumber,
pageType:a.pageType,searchQuery:a.searchQuery,stage:xa.getStage(),weblabs:a.weblabs,widgetGroupId:a.widgetGroupId,widgetIndex:void 0,widgetType:a.widgetType},zb(a.marketplaceId),k);q.reportResponseReceived();r={advertiserId:a.advertiserId,campaignId:a.campaignId,contentHash:a.contentHash,headline:a.headline,imageUrl:a.imageUrl,storeCta:a.storeCta,instrumentationPixelUrl:a.instrumentationPixelUrl,linkUrl:a.clickUrl,metricsIdentifier:a.metricsIdentifier,videoPreviewImageSrc:a.videoPreviewImageSrc,videoSrc:a.videoSrc,
ccSrc:a.ccSrc,videoOrientation:a.videoOrientation,hlsVideoSrc:b};u=A["default"].cardRoot.querySelector('[data-type="videoContainer"]');v=A["default"].cardRoot.querySelector('[data-type="ctaContainer"]');x=A["default"].cardRoot.querySelector(f);N=A["default"].cardRoot.querySelector('[id="headlineContainer"]');R=null;pa=A["default"].cardRoot.querySelector(".sbv-ad-content-container");if(!u)return q.reportMissingVideoElement(r),[2];if(!v||!x||!N)return q.reportMissingBrandElement(r),[2];n&&pa&&(qa=new Qb(pa),
qa.attach());Ta=d.getTreatment(M.SBV_723533)===I.T1;Ua={shouldEnablePauseButton:Ta,shouldEnableVideoCleanup:Sb(d),shouldEnableReduceMotionEffects:d.getTreatment(M.SBV_842986)===I.T1};Va=new Ab(q,r,{},qa);ra=new Cb(u,Va,r,!1,!1,Ua);if(g&&(R=A["default"].cardRoot.querySelector('[data-type="productImageLinkContainer"]'),!R))return q.reportMissingProductElement(r),[2];ia();yb(q,{cardName:"sbVideoStores",enableAdFeedback:e,isAdFeedbackForCards:h});(Wa=A["default"].cardRoot.querySelector('[data-type="playIcon"]'))&&
Wa.addEventListener("click",function(ec){return ra.play()});(Tb=d.getTreatment(M.SBV_485007)===I.T1)&&Ub(q,r,a);b&&q.reportHLSVideoRendered(r);Xa=new Ob(q,ra);Ya=new Pb({callToActionElement:v,brandLogoElement:x,headlineElement:N,productElements:[R]},Xa);Ya.setupWidgetEvents();return[2]})})},Za=function(c,f,g){if(f&&g){c=c.pageNumber;var e=Da.getItem(f)||{},b=e[g];if(b&&b.pageNumber!==c)return!1;e[g]={pageNumber:c};Da.addItem(f,e)}return!0},Ub=function(c,f,g){var e=f.contentHash,b=Za(g,"adsInfoByCampaignAndAdvId",
f.advertiserId+":"+f.campaignId);e=Za(g,"adsInfoByContentHash",e);g=ha.CROSS_PAGE;b=!b;e=!e;if(b||e)c.reportDupe(f,g),b&&c.reportDupe(f,g,V.CAMPAIGN_AND_ADV_ID),e&&c.reportDupe(f,g,V.CONTENT_HASH)},S=function(c,f){return c.querySelector("[class*="+f+"]")},Wb=function(c,f,g){c=JSON.parse(c);c.adCreativeMetaData=f.adCreativeMetaData;c.feedbackFormContainerId=g;return encodeURI(JSON.stringify(c))},Xb=function(c,f,g,e){return p.__awaiter(void 0,void 0,void 0,function(){var b,a,d,h,n,k,q,r;return p.__generator(this,
function(u){b="adFeedbackModal_"+c;u=(null===(r=S(f,"ad-feedback-modal-container"))||void 0===r?void 0:r.className)||"";a="."+f.className+" ."+u.replace(" ",".");h=(d=g().adCreativeMetaData.adCreativeDetails)?d.length:0;n=f.dataset.deviceType||"desktop";u=Math.max(560,125*h+130);var v=h;var x=n;v=e&&"true"===e.toLowerCase()?2>v?605:810:"tablet"==x?2>v?545:775:2>v?430:645;k={a11yOpenMessage:"",width:u,height:v};try{return q=kb["default"].create(b,a,k),[2,q]}catch(N){throw y.count("adfeedback:cards:clientDesktop:modalCreation:failure",
1),Error("Modal Creation Failed : "+N);}})})},$b=function(c,f,g,e,b,a){var d="rtl"===document.getElementsByTagName("html")[0].dir?"ad-feedback-loading-spinnner-rtl":"ad-feedback-loading-spinnner";var h=S(L["default"].cardRoot,d);c.on("beforeShow",function(){return p.__awaiter(void 0,void 0,void 0,function(){var n;return p.__generator(this,function(k){switch(k.label){case 0:return n=Yb(c,f,g),[4,c.render(function(q){var r="250px",u=g().adCreativeMetaData.adCreativeDetails;u&&2>u.length&&(r="150px");
h.style.marginTop=r;q.innerHTML="";r=q.appendChild;u=document.getElementsByTagName("html")[0].dir;var v=L["default"].createElement("div"),x=L["default"].createElement("div");v.innerHTML=b;"rtl"===u?(v.setAttribute("style",'box-sizing: border-box; color: rgb(15, 17, 17); font-family: "Amazon Ember", Arial, sans-serif; font-size: 16px; font-weight: 700; line-height: 24px; margin-bottom: 0px; margin-left: 28px; margin-right: 0px; margin-top: 0px; min-height: 56px; padding-bottom: 16px; padding-left: 0px; padding-right: 25px; padding-top: 16px; text-align: right; text-rendering: optimizelegibility; visibility: visible;'),
x.setAttribute("style",'background-attachment: scroll; background-clip: border-box; background-color: rgb(240, 242, 242); background-image: linear-gradient(to left, #EFEFEF 66.72%, #FFFFFF); background-origin: padding-box; background-position: 0% 0%; background-position-x: 0%; background-position-y: 0%; background-repeat: repeat; background-size: auto; border-bottom-color: rgb(213, 217, 217); border-bottom-left-radius: 0px; border-bottom-right-radius: 0px; border-top-left-radius: 8px; border-top-right-radius: 8px; box-sizing: border-box; color: rgb(15, 17, 17); display: block; font-family: "Amazon Ember", Arial, sans-serif; font-size: 14px; line-height: 20px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 24px; padding-right: 24px; padding-top: 0px; position: relative; text-align: right; visibility: visible; z-index: 10;')):
(v.setAttribute("style",'box-sizing: border-box; color: rgb(15, 17, 17); font-family: "Amazon Ember", Arial, sans-serif; font-size: 16px; font-weight: 700; line-height: 24px; margin-bottom: 0px; margin-left: 0px; margin-right: 28px; margin-top: 0px; min-height: 56px; padding-bottom: 16px; padding-left: 25px; padding-right: 0px; padding-top: 16px; text-align: left; text-rendering: optimizelegibility; visibility: visible;'),x.setAttribute("style",'background-attachment: scroll; background-clip: border-box; background-color: rgb(240, 242, 242); background-image: linear-gradient(to right, #EFEFEF 66.72%, #FFFFFF); background-origin: padding-box; background-position: 0% 0%; background-position-x: 0%; background-position-y: 0%; background-repeat: repeat; background-size: auto; border-bottom-color: rgb(213, 217, 217); border-bottom-left-radius: 0px; border-bottom-right-radius: 0px; border-top-left-radius: 8px; border-top-right-radius: 8px; box-sizing: border-box; color: rgb(15, 17, 17); display: block; font-family: "Amazon Ember", Arial, sans-serif; font-size: 14px; line-height: 20px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 24px; padding-right: 24px; padding-top: 0px; position: relative; text-align: left; visibility: visible; z-index: 10;'));
x.appendChild(v);r.call(q,x);r=document.getElementsByTagName("html")[0].dir;u=L["default"].createElement("div");"rtl"===r?u.setAttribute("style","padding-bottom: 16px; padding-right: 50px ; padding-top: 16px; justify-content: center; align-items: center;"):u.setAttribute("style","padding-bottom: 16px; padding-left: 50px ; padding-top: 16px; justify-content: center; align-items: center;");Zb(h,u,e,n,a);q.appendChild(u)})];case 1:return k.sent(),[2]}})})})},Yb=function(c,f,g){g=g();var e=g.adCreativeMetaData.adCreativeDetails;
null===e||void 0===e?void 0:e.sort(function(b,a){return b.adCreativeIndex<a.adCreativeIndex?-1:1});return Wb(f,g,c.id)},Zb=function(c,f,g,e,b){f.appendChild(c);"function"==typeof y.uet&&y.uet("bb","adfeedback:cards:clientDesktop:fetchFormContent:time",{wb:1});lb["default"].post("/af/multi-creative/feedback-form",{accepts:"application/json",contentType:"application/json",additionalHeaders:{"Accept-Language":""===g?"en-US":g}},{pl:e,deviceType:"desktop"}).then(function(a){return p.__awaiter(void 0,
void 0,void 0,function(){var d,h,n;return p.__generator(this,function(k){"function"==typeof y.uet&&y.uet("be","adfeedback:cards:clientDesktop:fetchFormContent:time",{wb:1});y.count("adfeedback:cards:clientDesktop:fetchFormContent:success",1);d=L["default"].createElement("div");d.innerHTML=String(a.responseBody);for(h=0;h<d.children.length;++h)n=d.children[h],"SCRIPT"===n.tagName?sa("script",n,f):"LINK"===n.tagName?sa("link",n,f):sa("div",n,f);f.removeChild(c);return[2]})})}).catch(function(){"function"==
typeof y.uet&&y.uet("be","adfeedback:cards:clientDesktop:fetchFormContent:time",{wb:1});y.count("adfeedback:cards:clientDesktop:fetchFormContent:failure",1);f.innerHTML=b});"function"==typeof y.uex&&y.uex("ld","adfeedback:cards:clientDesktop:fetchFormContent:time",{wb:1})},sa=function(c,f,g){var e=L["default"].createElement(c);e.innerHTML=f.innerHTML;f.getAttributeNames().forEach(function(b){e.setAttribute(b,f.getAttribute(b)||"")});g.appendChild(e)},$a={},ac=function(c,f){return p.__awaiter(void 0,
void 0,void 0,function(){var g,e,b,a,d,h,n,k,q;return p.__generator(this,function(r){g=S(c,"ad-feedback-primary-link");e=f().adFeedbackLabelId;b=wa["default"].setup();a="open-modal"+e;d=f().adCreativeMetaData.adCreativeDetails;h=c.dataset;n=h.isDsaEnabled;k=h.weblabTreatment;q=String(n);"undefined"===q&&(q=d&&0<d.length?d[0].selectionSignals?"true":"false":"false");"true"===q&&"T1"!==k&&(q="false");b.attach(a,g);b.define(a,"click",function(){return p.__awaiter(void 0,void 0,void 0,function(){var u;
return p.__generator(this,function(v){switch(v.label){case 0:return(u=$a[e])?[3,2]:[4,Xb(e,c,f,q)];case 1:u=v.sent();var x=c.dataset,N=x.formHeaderText,R=x.dsaFormHeaderText;$b(u,x.adFeedbackPayload,f,x.currentLocale,"true"===q?R:N,x.formLoadErrorText);$a[e]=u;v.label=2;case 2:return u.show(),[2]}})})});return[2]})})},bc=function(c,f){var g=wa["default"].setup(),e="mouse-enter"+f;f="mouse-leave"+f;var b=S(c,"ad-feedback-primary-link"),a=S(c,"ad-feedback-text-desktop"),d=S(c,"ad-feedback-sprite");
g.attach(e,b);g.define(e,"mouseenter",function(){d.style.backgroundPosition="0px -12px";a.style.color="#111111"});g.attach(f,b);g.define(f,"mouseleave",function(){d.style.backgroundPosition="0px 0px";a.style.color="#555"})},cc=function(c){return p.__awaiter(void 0,void 0,void 0,function(){var f,g,e,b;return p.__generator(this,function(a){switch(a.label){case 0:return a.trys.push([0,3,,4]),f=c(),g=A["default"].cardRoot.getElementsByClassName("adFeedbackMainComponent_"+f.adFeedbackLabelId)[0],e=g.dataset.isSponsoredLabelActive,
"false"===(e||"false").toLowerCase()?[2]:[4,bc(g,f.adFeedbackLabelId)];case 1:return a.sent(),[4,ac(g,c)];case 2:return a.sent(),[3,4];case 3:throw b=a.sent(),y.count("adfeedback:cards:clientDesktop:enableAdFeedback:failure",1),Error("Failed to call enableAdFeedback for desktop client : "+b);case 4:return[2]}})})},ta=function(){return p.__awaiter(void 0,void 0,void 0,function(){return p.__generator(this,function(c){Vb({isAsinCard:!0,brandLogoElementSelector:'[data-type="brandLogo"]',enableAdFeedback:cc});
return[2]})})};ea._operationNames=[];ea.card=function(){return p.__awaiter(void 0,void 0,void 0,function(){return p.__generator(this,function(c){ib["default"].pageReady.then(ta,ta);return[2]})})};ea.initOnReady=ta});
